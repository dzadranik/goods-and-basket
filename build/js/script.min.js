"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var n=0,o=new Array(t.length);n<t.length;n++)o[n]=t[n];return o}}var basket=new BasketSetting,goods=new GoodSetting,paging=new Paging,container=new ContainerClassSetting;function addContentToContainer(t,n){var o=document.querySelector(t);o&&(o.innerHTML=n)}function ContainerClassSetting(){this.findContainersAndRemoveClass=function(t,n){!function t(n,o){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e<n.length)return n[e].classList.remove(o),t(n,o,e+1)}(document.querySelectorAll(t),n)}}function GoodSetting(){var t=[],n=!1,o="name";this.loadGoods=function(){fetch("https://dzadranik.github.io/goods-and-basket/src/json/goods.json").then((function(t){return t.json()})).then((function(e){!function(n){t=n,addContentToContainer(".js-good",n.map((function(t){return function(t){var n=t.id,o=t.image,e=t.title,a=t.price,i=t.descr;return'<div class="good__item js-good-item" data-good-id='.concat(n,'>\n\t\t\t\t\t<div class="good__image"><img src="').concat(o,'"/></div>\n\t\t\t\t\t<div class="good__information">\n\t\t\t\t\t\t<div class="good__title">').concat(e,'</div>\n\t\t\t\t\t\t<div class="good__price">').concat(a,' руб</div>\n\t\t\t\t\t\t<div class="good__description">').concat(function(t,n){if(t.length>n){var o=t.lastIndexOf(" ",n);return"".concat(t.slice(0,o)," ...")}return t}(i,65),'</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="good__transaction">\n\t\t\t\t\t\t<button class="good__button js-add-to-basket">Добавить в корзину</button>\n\t\t\t\t\t\t<div class="good__basket-feedback js-good-in-basket"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>')}(t)})).join(""))}(paging.addPagingGetItemsInPage(function(t){return n&&(t=function(t){return t.filter((function(t){return t.avaliable}))}(t)),"cost"==o?t=function(t){return t.sort((function(t,n){return t.price-n.price}))}(t):"name"==o&&(t=function(t){return t.sort((function(t,n){var o=t.title.toLowerCase(),e=n.title.toLowerCase();return o<e?-1:o<e?1:void 0}))}(t)),t}(e)))}))},this.setAvaliable=function(t){n=t,paging.setActivePage(0),this.loadGoods()},this.setSorting=function(t){o!=t&&(o=t,this.loadGoods())},this.getGoodInformation=function(n){return t.find((function(t){return t.id==n}))}}function Paging(){var t=0,n=function(n){return'<button \n\t\t\tclass="pagination__button js-pagination-button '.concat(n===t?"active":"",'" \n\t\t\tdata-p-button-number="').concat(n+1,'">\n\t\t\t\t').concat(n+1,"\n\t\t\t</button>")},o=function t(o,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return o<e?t(o+1,e,a+=n(o)):a};this.setActivePage=function(n){t=n,goods.loadGoods()},this.addPagingGetItemsInPage=function(n){return addContentToContainer(".js-pagination",function(n){var e=Math.ceil(n.length/5),a="";return e>6?t<2||t>e-3?(a+=o(0,3),a+="<span class='pagination__dots'>...</span>",a+=o(e-3,e)):2==t?(a+=o(0,4),a+="<span class='pagination__dots'>...</span>",a+=o(e-1,e)):t==e-3?(a+=o(0,1),a+="<span class='pagination__dots'>...</span>",a+=o(e-4,e)):t>2&&t<e-3&&(a+=getAnyPButtons(0,1),a+=o(),a+=getAnyPButtons(t-1,t+2),a+=o(),a+=getAnyPButtons(e-1,e)):a+=o(0,e),a}(n)),function(n){var o=5*t,e=o+5;return n.slice(o,e)}(n)}}function BasketSetting(){var t=[],n=function(){addContentToContainer(".js-basket-good",t.map((function(t){return function(t){var n=t.id,o=t.image,e=t.title,a=t.count;return'<div class="basket__good-item" data-b-good-id="'.concat(n,'">\n\t\t\t<button class="basket__good-remove js-remove-good">&#128938;</button>\n\t\t\t<div class="basket__good-image"><img src="').concat(o,'"/></div>\n\t\t\t<div class="basket__good-name">').concat(e,'</div>\n\t\t\t<div class="basket__good-amout">').concat(a,"</div>\n\t\t</div>")}(t)})).join(""))},o=function(){addContentToContainer(".js-count-result",t.reduce((function(t,n){return t+n.count*n.price}),0))},e=function(){localStorage.goodsInBasket=JSON.stringify(t),n(),o()};this.getLocalSorage=function(){null!=localStorage.getItem("goodsInBasket")&&(t=JSON.parse(localStorage.getItem("goodsInBasket"))),n(),o()},this.getCountGoodsInBasket=function(){addContentToContainer(".js-good-in-basket",t.reduce((function(t,n){return t+n.count}),0))},this.addGoodToBasket=function(n){!function(n){var o=t.find((function(t){return t.id===n.id}));o?o.count++:(n.count=1,t=[].concat(_toConsumableArray(t),[n]))}(n),e()},this.removeGoodFromBasket=function(n){!function(n){var o=t.findIndex((function(t){return t.id===+n}));t.splice(o,1)}(n),e()}}goods.loadGoods(),basket.getLocalSorage(),document.addEventListener("DOMContentLoaded",(function(){var t=function(t,n,o){document.querySelector(t).addEventListener(n,(function(t){return o(t)}))};t(".js-pagination","click",(function(t){var n=t.target;n.classList.contains("js-pagination-button")&&!n.classList.contains("active")&&paging.setActivePage(n.dataset.pButtonNumber-1)})),t(".js-sorting-buttons","click",(function(t){var n=t.target;if(n.classList.contains("js-sorting")&&!n.classList.contains("active")){var o=n.dataset.sorting;container.findContainersAndRemoveClass(".js-sorting","active"),goods.setSorting(o),n.classList.add("active")}})),t(".js-avaliable","change",(function(t){goods.setAvaliable(t.target.checked)})),t(".js-good","click",(function(t){if(t.target.classList.contains("js-add-to-basket")){var n=t.target.closest(".js-good-item").dataset.goodId;basket.addGoodToBasket(goods.getGoodInformation(n))}})),t(".js-basket-good","click",(function(t){t.target.classList.contains("js-remove-good")&&basket.removeGoodFromBasket(t.target.parentElement.dataset.bGoodId)}))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJfdG9Db25zdW1hYmxlQXJyYXkiLCJhcnIiLCJfYXJyYXlXaXRob3V0SG9sZXMiLCJfaXRlcmFibGVUb0FycmF5IiwiX25vbkl0ZXJhYmxlU3ByZWFkIiwiVHlwZUVycm9yIiwiaXRlciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiT2JqZWN0IiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJjYWxsIiwiQXJyYXkiLCJmcm9tIiwiaXNBcnJheSIsImkiLCJhcnIyIiwibGVuZ3RoIiwiYmFza2V0IiwiQmFza2V0U2V0dGluZyIsImdvb2RzIiwiR29vZFNldHRpbmciLCJwYWdpbmciLCJQYWdpbmciLCJjb250YWluZXIiLCJDb250YWluZXJDbGFzc1NldHRpbmciLCJhZGRDb250ZW50VG9Db250YWluZXIiLCJjb250YWluZXJDbGFzcyIsImVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpbm5lckhUTUwiLCJ0aGlzIiwiZmluZENvbnRhaW5lcnNBbmRSZW1vdmVDbGFzcyIsImNsYXNzTmFtZSIsInJlbW92ZUNsYXNzSW5Db250YWluZXIiLCJhbGxDb250YWluZXJzIiwiYXJndW1lbnRzIiwidW5kZWZpbmVkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwicXVlcnlTZWxlY3RvckFsbCIsImdvb2RzSW5QYWdlIiwiYXZhbGlhYmxlIiwic29ydGluZ1ZhbHVlIiwibG9hZEdvb2RzIiwiZmV0Y2giLCJ0aGVuIiwicmVzcG9uc2UiLCJqc29uIiwibWFwIiwiZ29vZCIsImlkIiwiaW1hZ2UiLCJ0aXRsZSIsInByaWNlIiwiZGVzY3IiLCJjb25jYXQiLCJtYXhMZW5ndGgiLCJnYXAiLCJsYXN0SW5kZXhPZiIsInNsaWNlIiwidHJ1bmNhdGUiLCJnZXRHb29kQ29udGVudCIsImpvaW4iLCJhZGRHb29kc1RvQ29udGFpbmVyIiwiYWRkUGFnaW5nR2V0SXRlbXNJblBhZ2UiLCJmaWx0ZXIiLCJlbGVtIiwic29ydGluZ0F2YWxpYWJsZSIsInNvcnQiLCJwcmV2IiwibmV4dCIsInNvcnRpbmdCeUNvc3QiLCJ4IiwidG9Mb3dlckNhc2UiLCJ5Iiwic29ydGluZ0J5TmFtZSIsInNvcnRpbmciLCJzZXRBdmFsaWFibGUiLCJ2YWx1ZSIsInNldEFjdGl2ZVBhZ2UiLCJzZXRTb3J0aW5nIiwiZ2V0R29vZEluZm9ybWF0aW9uIiwiZmluZCIsIml0ZW0iLCJudW1iZXJBY3RpdmVQYWdlIiwiZ2V0UEJ1dHRvbkNvbnRlbnQiLCJudW1iZXIiLCJnZXRQQnV0dG9uc051bWJlckNvbnRlbnQiLCJmaXJzdCIsImxhc3QiLCJwQnV0dG9uc0NvbnRlbnQiLCJpdGVtcyIsImFtb3VudEJ1dHRvbnMiLCJNYXRoIiwiY2VpbCIsImdldEFueVBCdXR0b25zIiwiZ2V0UEJ1dHRvbnNDb250ZW50IiwiZmlyc3RJdGVtIiwibGFzdEl0ZW0iLCJnZXRJdGVtc0luQWN0aXZlUGFnZSIsImdvb2RzSW5CYXNrZXQiLCJhZGRHb29kVG9Db250YWluZXIiLCJjb3VudCIsImNvdW50VG90YWxDb3N0IiwicmVkdWNlIiwic3VtIiwicmVsb2FkQmFza2V0IiwibG9jYWxTdG9yYWdlIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldExvY2FsU29yYWdlIiwiZ2V0SXRlbSIsInBhcnNlIiwiZ2V0Q291bnRHb29kc0luQmFza2V0IiwiYWRkR29vZFRvQmFza2V0IiwiZ29vZEluQmFza2V0IiwiZmluZEdvb2RBbmRBZGQiLCJyZW1vdmVHb29kRnJvbUJhc2tldCIsImluZGV4IiwiZmluZEluZGV4Iiwic3BsaWNlIiwiZmluZEdvb2RBbmRSZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlciIsImV2ZW50TmFtZSIsImZuIiwiZXZlbnQiLCJ0YXJnZXRFbGVtZW50IiwidGFyZ2V0IiwiY29udGFpbnMiLCJkYXRhc2V0IiwicEJ1dHRvbk51bWJlciIsInNvcnRpbmdTZXR0aW5nIiwiYWRkIiwiY2hlY2tlZCIsImdvb2RJZCIsImNsb3Nlc3QiLCJwYXJlbnRFbGVtZW50Iiwi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NEJGLEVBQWMxRixVQUFVNEYsU0FBUyxXQUNqRzdHLE9BQU8yRCxjQUFjZ0QsRUFBY0csUUFBUUMsY0FBZ0IsTUFLN0RSLEVBQVEsc0JBQXVCLFNBQVMsU0FBQUcsR0FDdkMsSUFBTUMsRUFBZ0JELEVBQU1FLE9BQzVCLEdBQUlELEVBQWMxRixVQUFVNEYsU0FBUyxnQkFBa0JGLEVBQWMxRixVQUFVNEYsU0FBUyxVQUFXLENBQ2xHLElBQU1HLEVBQWlCTCxFQUFjRyxRQUFRdEQsUUFDN0N0RCxVQUFVUyw2QkFBNkIsY0FBZSxVQUN0RGIsTUFBTThELFdBQVdvRCxHQUNqQkwsRUFBYzFGLFVBQVVnRyxJQUFJLGNBSzlCVixFQUFRLGdCQUFpQixVQUFVLFNBQUFHLEdBQ2xDNUcsTUFBTTJELGFBQWFpRCxFQUFNRSxPQUFPTSxZQUlqQ1gsRUFBUSxXQUFZLFNBQVMsU0FBQUcsR0FDNUIsR0FBSUEsRUFBTUUsT0FBTzNGLFVBQVU0RixTQUFTLG9CQUFxQixDQUN4RCxJQUFJTSxFQUFTVCxFQUFNRSxPQUFPUSxRQUFRLGlCQUFpQk4sUUFBUUssT0FDM0R2SCxPQUFPa0csZ0JBQWdCaEcsTUFBTStELG1CQUFtQnNELFFBS2xEWixFQUFRLGtCQUFtQixTQUFTLFNBQUFHLEdBQy9CQSxFQUFNRSxPQUFPM0YsVUFBVTRGLFNBQVMsbUJBQ25DakgsT0FBT3FHLHFCQUFxQlMsRUFBTUUsT0FBT1MsY0FBY1AsUUFBUVEiLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgYmFza2V0ID0gbmV3IEJhc2tldFNldHRpbmcoKSxcclxuXHRnb29kcyA9IG5ldyBHb29kU2V0dGluZygpLFxyXG5cdHBhZ2luZyA9IG5ldyBQYWdpbmcoKSxcclxuXHRjb250YWluZXIgPSBuZXcgQ29udGFpbmVyQ2xhc3NTZXR0aW5nKCk7XHJcblxyXG5nb29kcy5sb2FkR29vZHMoKTtcclxuYmFza2V0LmdldExvY2FsU29yYWdlKCk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XHJcblx0Y29uc3QgaGFuZGxlciA9IChlbGVtZW50LCBldmVudE5hbWUsIGZuKSA9PiB7XHJcblx0XHRjb25zdCBlbGVtZW50Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KTtcclxuXHRcdGVsZW1lbnRDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGV2ZW50ID0+IGZuKGV2ZW50KSk7XHJcblx0fTtcclxuXHJcblx0Ly/RgdC70YPRiNCw0LvQutCwINC60L3QvtC/0L7QuiDQv9Cw0LPQuNC90LDRgtC+0YDQsFxyXG5cdGhhbmRsZXIoJy5qcy1wYWdpbmF0aW9uJywgJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0Y29uc3QgdGFyZ2V0RWxlbWVudCA9IGV2ZW50LnRhcmdldDtcclxuXHRcdGlmICh0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanMtcGFnaW5hdGlvbi1idXR0b24nKSAmJiAhdGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7XHJcblx0XHRcdHBhZ2luZy5zZXRBY3RpdmVQYWdlKHRhcmdldEVsZW1lbnQuZGF0YXNldC5wQnV0dG9uTnVtYmVyIC0gMSk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdC8vINGB0LvRg9GI0LDQu9C60LAg0YHQvtGA0YLQuNGA0L7QstC+0LpcclxuXHRoYW5kbGVyKCcuanMtc29ydGluZy1idXR0b25zJywgJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0Y29uc3QgdGFyZ2V0RWxlbWVudCA9IGV2ZW50LnRhcmdldDtcclxuXHRcdGlmICh0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanMtc29ydGluZycpICYmICF0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcclxuXHRcdFx0Y29uc3Qgc29ydGluZ1NldHRpbmcgPSB0YXJnZXRFbGVtZW50LmRhdGFzZXQuc29ydGluZztcclxuXHRcdFx0Y29udGFpbmVyLmZpbmRDb250YWluZXJzQW5kUmVtb3ZlQ2xhc3MoJy5qcy1zb3J0aW5nJywgJ2FjdGl2ZScpO1xyXG5cdFx0XHRnb29kcy5zZXRTb3J0aW5nKHNvcnRpbmdTZXR0aW5nKTtcclxuXHRcdFx0dGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0Ly8g0YHQu9GD0YjQsNC70LrQsCDRgdC+0YDRgtC40YDQvtCy0LrQuCDQv9C+INC90LDQu9C40YfQuNGOXHJcblx0aGFuZGxlcignLmpzLWF2YWxpYWJsZScsICdjaGFuZ2UnLCBldmVudCA9PiB7XHJcblx0XHRnb29kcy5zZXRBdmFsaWFibGUoZXZlbnQudGFyZ2V0LmNoZWNrZWQpO1xyXG5cdH0pO1xyXG5cclxuXHQvLyDQutC90L7Qv9C60LAg0LTQvtCx0LDQstC40YLRjCDQsiDQutC+0YDQt9C40L3Rg1xyXG5cdGhhbmRsZXIoJy5qcy1nb29kJywgJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0aWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLWFkZC10by1iYXNrZXQnKSkge1xyXG5cdFx0XHRsZXQgZ29vZElkID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5qcy1nb29kLWl0ZW0nKS5kYXRhc2V0Lmdvb2RJZDtcclxuXHRcdFx0YmFza2V0LmFkZEdvb2RUb0Jhc2tldChnb29kcy5nZXRHb29kSW5mb3JtYXRpb24oZ29vZElkKSk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdC8vINC60L3QvtC/0LrQsCDRg9C00LDQu9C40YLRjCDQuNC3INC60L7RgNC30LjQvdGLXHJcblx0aGFuZGxlcignLmpzLWJhc2tldC1nb29kJywgJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0aWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLXJlbW92ZS1nb29kJykpIHtcclxuXHRcdFx0YmFza2V0LnJlbW92ZUdvb2RGcm9tQmFza2V0KGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50LmRhdGFzZXQuYkdvb2RJZCk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn0pO1xyXG5cclxuLy/QlNC+0LHQsNCy0LvQtdC90LjQtSDRjdC70LXQvNC10L3RgtC+0LIg0LIg0LrQvtC90YLQtdC50L3QtdGAXHJcbmZ1bmN0aW9uIGFkZENvbnRlbnRUb0NvbnRhaW5lcihjb250YWluZXJDbGFzcywgZWxlbWVudCkge1xyXG5cdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyQ2xhc3MpO1xyXG5cdGlmIChjb250YWluZXIpIGNvbnRhaW5lci5pbm5lckhUTUwgPSBlbGVtZW50O1xyXG59XHJcblxyXG4vL9GD0LTQsNC70LjRgtGMINC60LvQsNGB0YEg0YMg0LPRgNGD0L/Qv9GLINC60L7QvdGC0LXQudC90LXRgNC+0LJcclxuZnVuY3Rpb24gQ29udGFpbmVyQ2xhc3NTZXR0aW5nKCkge1xyXG5cdGNvbnN0IHJlbW92ZUNsYXNzSW5Db250YWluZXIgPSAoYWxsQ29udGFpbmVycywgY2xhc3NOYW1lLCBpID0gMCkgPT4ge1xyXG5cdFx0aWYgKGkgPCBhbGxDb250YWluZXJzLmxlbmd0aCkge1xyXG5cdFx0XHRhbGxDb250YWluZXJzW2ldLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcclxuXHRcdFx0cmV0dXJuIHJlbW92ZUNsYXNzSW5Db250YWluZXIoYWxsQ29udGFpbmVycywgY2xhc3NOYW1lLCBpICsgMSk7XHJcblx0XHR9XHJcblx0fTtcclxuXHR0aGlzLmZpbmRDb250YWluZXJzQW5kUmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbihjb250YWluZXJDbGFzcywgY2xhc3NOYW1lKSB7XHJcblx0XHRsZXQgYWxsQ29udGFpbmVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29udGFpbmVyQ2xhc3MpO1xyXG5cdFx0cmVtb3ZlQ2xhc3NJbkNvbnRhaW5lcihhbGxDb250YWluZXJzLCBjbGFzc05hbWUpO1xyXG5cdH07XHJcbn1cclxuXHJcbi8vINGC0L7QstCw0YDRi1xyXG5mdW5jdGlvbiBHb29kU2V0dGluZygpIHtcclxuXHRsZXQgZ29vZHNJblBhZ2UgPSBbXSxcclxuXHRcdGF2YWxpYWJsZSA9IGZhbHNlLFxyXG5cdFx0c29ydGluZ1ZhbHVlID0gJ25hbWUnO1xyXG5cclxuXHRjb25zdCBzb3J0aW5nQXZhbGlhYmxlID0gZ29vZHMgPT4ge1xyXG5cdFx0cmV0dXJuIGdvb2RzLmZpbHRlcihlbGVtID0+IGVsZW0uYXZhbGlhYmxlKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzb3J0aW5nQnlDb3N0ID0gZ29vZHMgPT4ge1xyXG5cdFx0cmV0dXJuIGdvb2RzLnNvcnQoKHByZXYsIG5leHQpID0+IHByZXYucHJpY2UgLSBuZXh0LnByaWNlKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzb3J0aW5nQnlOYW1lID0gZ29vZHMgPT4ge1xyXG5cdFx0cmV0dXJuIGdvb2RzLnNvcnQoKHByZXYsIG5leHQpID0+IHtcclxuXHRcdFx0Y29uc3QgeCA9IHByZXYudGl0bGUudG9Mb3dlckNhc2UoKTtcclxuXHRcdFx0Y29uc3QgeSA9IG5leHQudGl0bGUudG9Mb3dlckNhc2UoKTtcclxuXHRcdFx0aWYgKHggPCB5KSByZXR1cm4gLTE7XHJcblx0XHRcdGlmICh4IDwgeSkgcmV0dXJuIDE7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzb3J0aW5nID0gZ29vZHMgPT4ge1xyXG5cdFx0aWYgKGF2YWxpYWJsZSkgZ29vZHMgPSBzb3J0aW5nQXZhbGlhYmxlKGdvb2RzKTtcclxuXHJcblx0XHRpZiAoc29ydGluZ1ZhbHVlID09ICdjb3N0JykgZ29vZHMgPSBzb3J0aW5nQnlDb3N0KGdvb2RzKTtcclxuXHRcdGVsc2UgaWYgKHNvcnRpbmdWYWx1ZSA9PSAnbmFtZScpIGdvb2RzID0gc29ydGluZ0J5TmFtZShnb29kcyk7XHJcblx0XHRyZXR1cm4gZ29vZHM7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgdHJ1bmNhdGUgPSBmdW5jdGlvbihkZXNjciwgbWF4TGVuZ3RoKSB7XHJcblx0XHRpZiAoZGVzY3IubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XHJcblx0XHRcdGxldCBnYXAgPSBkZXNjci5sYXN0SW5kZXhPZignICcsIG1heExlbmd0aCk7XHJcblx0XHRcdHJldHVybiBgJHtkZXNjci5zbGljZSgwLCBnYXApfSAuLi5gO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRlc2NyO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldEdvb2RDb250ZW50ID0gZ29vZCA9PiB7XHJcblx0XHRsZXQgeyBpZCwgaW1hZ2UsIHRpdGxlLCBwcmljZSwgZGVzY3IgfSA9IGdvb2Q7XHJcblx0XHRyZXR1cm4gYDxkaXYgY2xhc3M9XCJnb29kX19pdGVtIGpzLWdvb2QtaXRlbVwiIGRhdGEtZ29vZC1pZD0ke2lkfT5cclxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJnb29kX19pbWFnZVwiPjxpbWcgc3JjPVwiJHtpbWFnZX1cIi8+PC9kaXY+XHJcblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9faW5mb3JtYXRpb25cIj5cclxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX3RpdGxlXCI+JHt0aXRsZX08L2Rpdj5cclxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX3ByaWNlXCI+JHtwcmljZX0g0YDRg9CxPC9kaXY+XHJcblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJnb29kX19kZXNjcmlwdGlvblwiPiR7dHJ1bmNhdGUoZGVzY3IsIDY1KX08L2Rpdj5cclxuXHRcdFx0XHRcdDwvZGl2PlxyXG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX3RyYW5zYWN0aW9uXCI+XHJcblx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJnb29kX19idXR0b24ganMtYWRkLXRvLWJhc2tldFwiPtCU0L7QsdCw0LLQuNGC0Ywg0LIg0LrQvtGA0LfQuNC90YM8L2J1dHRvbj5cclxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX2Jhc2tldC1mZWVkYmFjayBqcy1nb29kLWluLWJhc2tldFwiPjwvZGl2PlxyXG5cdFx0XHRcdFx0PC9kaXY+XHJcblx0XHRcdFx0PC9kaXY+YDtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBhZGRHb29kc1RvQ29udGFpbmVyID0gZ29vZHMgPT4ge1xyXG5cdFx0Z29vZHNJblBhZ2UgPSBnb29kcztcclxuXHRcdGNvbnN0IGdvb2RzQ29udGVudCA9IGdvb2RzLm1hcChnb29kID0+IGdldEdvb2RDb250ZW50KGdvb2QpKS5qb2luKCcnKTtcclxuXHRcdGFkZENvbnRlbnRUb0NvbnRhaW5lcignLmpzLWdvb2QnLCBnb29kc0NvbnRlbnQpO1xyXG5cdH07XHJcblxyXG5cdHRoaXMubG9hZEdvb2RzID0gZnVuY3Rpb24oKSB7XHJcblx0XHRmZXRjaCgnaHR0cHM6Ly9kemFkcmFuaWsuZ2l0aHViLmlvL2dvb2RzLWFuZC1iYXNrZXQvc3JjL2pzb24vZ29vZHMuanNvbicpXHJcblx0XHRcdC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcclxuXHRcdFx0LnRoZW4oZ29vZHMgPT4ge1xyXG5cdFx0XHRcdGFkZEdvb2RzVG9Db250YWluZXIocGFnaW5nLmFkZFBhZ2luZ0dldEl0ZW1zSW5QYWdlKHNvcnRpbmcoZ29vZHMpKSk7XHJcblx0XHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuc2V0QXZhbGlhYmxlID0gZnVuY3Rpb24odmFsdWUpIHtcclxuXHRcdGF2YWxpYWJsZSA9IHZhbHVlO1xyXG5cdFx0cGFnaW5nLnNldEFjdGl2ZVBhZ2UoMCk7XHJcblx0XHR0aGlzLmxvYWRHb29kcygpO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuc2V0U29ydGluZyA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcblx0XHRpZiAoc29ydGluZ1ZhbHVlICE9IHZhbHVlKSB7XHJcblx0XHRcdHNvcnRpbmdWYWx1ZSA9IHZhbHVlO1xyXG5cdFx0XHR0aGlzLmxvYWRHb29kcygpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0R29vZEluZm9ybWF0aW9uID0gZnVuY3Rpb24oaWQpIHtcclxuXHRcdHJldHVybiBnb29kc0luUGFnZS5maW5kKGl0ZW0gPT4gaXRlbS5pZCA9PSBpZCk7XHJcblx0fTtcclxufVxyXG5cclxuLy/Qv9Cw0LPQuNC90LDRhtC40Y9cclxuZnVuY3Rpb24gUGFnaW5nKCkge1xyXG5cdGNvbnN0IGFtb3VudFBhZ2VJdGVtcyA9IDU7IC8vINC60L7Qu9C40YfQtdGB0YLQstC+INGN0LvQtdC80LXQvdGC0L7QsiDQvdCwINGB0YLRgNCw0L3QuNGG0LVcclxuXHRsZXQgbnVtYmVyQWN0aXZlUGFnZSA9IDA7IC8vINCw0LrRgtC40LLQvdCw0Y8g0YHRgtGA0LDQvdC40YbQsFxyXG5cclxuXHRjb25zdCBnZXRQQnV0dG9uQ29udGVudCA9IG51bWJlciA9PiB7XHJcblx0XHRyZXR1cm4gYDxidXR0b24gXHJcblx0XHRcdGNsYXNzPVwicGFnaW5hdGlvbl9fYnV0dG9uIGpzLXBhZ2luYXRpb24tYnV0dG9uICR7bnVtYmVyID09PSBudW1iZXJBY3RpdmVQYWdlID8gJ2FjdGl2ZScgOiAnJ31cIiBcclxuXHRcdFx0ZGF0YS1wLWJ1dHRvbi1udW1iZXI9XCIke251bWJlciArIDF9XCI+XHJcblx0XHRcdFx0JHtudW1iZXIgKyAxfVxyXG5cdFx0XHQ8L2J1dHRvbj5gO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldFBEb3RzQ29udGVudCA9ICgpID0+IHtcclxuXHRcdHJldHVybiBgPHNwYW4gY2xhc3M9J3BhZ2luYXRpb25fX2RvdHMnPi4uLjwvc3Bhbj5gO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldFBCdXR0b25zTnVtYmVyQ29udGVudCA9IChmaXJzdCwgbGFzdCwgcEJ1dHRvbnNDb250ZW50ID0gJycpID0+IHtcclxuXHRcdGlmIChmaXJzdCA8IGxhc3QpIHtcclxuXHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IGdldFBCdXR0b25Db250ZW50KGZpcnN0KTtcclxuXHRcdFx0cmV0dXJuIGdldFBCdXR0b25zTnVtYmVyQ29udGVudChmaXJzdCArIDEsIGxhc3QsIHBCdXR0b25zQ29udGVudCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gcEJ1dHRvbnNDb250ZW50O1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGdldFBCdXR0b25zQ29udGVudCA9IGl0ZW1zID0+IHtcclxuXHRcdGxldCBhbW91bnRCdXR0b25zID0gTWF0aC5jZWlsKGl0ZW1zLmxlbmd0aCAvIGFtb3VudFBhZ2VJdGVtcyksIC8vINC60L7Qu9C40YfQtdGB0YLQstC+INGB0YLRgNCw0L3QuNGGXHJcblx0XHRcdHBCdXR0b25zQ29udGVudCA9ICcnOyAvLyDRgNCw0LfQvNC10YLQutCwINC60L3QvtC/0L7QuiDQv9Cw0LPQuNC90LDRhtC40LhcclxuXHJcblx0XHRpZiAoYW1vdW50QnV0dG9ucyA+IDYpIHtcclxuXHRcdFx0aWYgKG51bWJlckFjdGl2ZVBhZ2UgPCAyIHx8IG51bWJlckFjdGl2ZVBhZ2UgPiBhbW91bnRCdXR0b25zIC0gMykge1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRQQnV0dG9uc051bWJlckNvbnRlbnQoMCwgMyk7XHJcblx0XHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IGdldFBEb3RzQ29udGVudCgpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRQQnV0dG9uc051bWJlckNvbnRlbnQoYW1vdW50QnV0dG9ucyAtIDMsIGFtb3VudEJ1dHRvbnMpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKG51bWJlckFjdGl2ZVBhZ2UgPT0gMikge1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRQQnV0dG9uc051bWJlckNvbnRlbnQoMCwgNCk7XHJcblx0XHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IGdldFBEb3RzQ29udGVudCgpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRQQnV0dG9uc051bWJlckNvbnRlbnQoYW1vdW50QnV0dG9ucyAtIDEsIGFtb3VudEJ1dHRvbnMpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKG51bWJlckFjdGl2ZVBhZ2UgPT0gYW1vdW50QnV0dG9ucyAtIDMpIHtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KDAsIDEpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRQRG90c0NvbnRlbnQoKTtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KGFtb3VudEJ1dHRvbnMgLSA0LCBhbW91bnRCdXR0b25zKTtcclxuXHRcdFx0fSBlbHNlIGlmIChudW1iZXJBY3RpdmVQYWdlID4gMiAmJiBudW1iZXJBY3RpdmVQYWdlIDwgYW1vdW50QnV0dG9ucyAtIDMpIHtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0QW55UEJ1dHRvbnMoMCwgMSk7XHJcblx0XHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IGdldFBCdXR0b25zTnVtYmVyQ29udGVudCgpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRBbnlQQnV0dG9ucyhudW1iZXJBY3RpdmVQYWdlIC0gMSwgbnVtYmVyQWN0aXZlUGFnZSArIDIpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRQQnV0dG9uc051bWJlckNvbnRlbnQoKTtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0QW55UEJ1dHRvbnMoYW1vdW50QnV0dG9ucyAtIDEsIGFtb3VudEJ1dHRvbnMpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KDAsIGFtb3VudEJ1dHRvbnMpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHBCdXR0b25zQ29udGVudDtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBnZXRJdGVtc0luQWN0aXZlUGFnZSA9IGl0ZW1zID0+IHtcclxuXHRcdGNvbnN0IGZpcnN0SXRlbSA9IG51bWJlckFjdGl2ZVBhZ2UgKiBhbW91bnRQYWdlSXRlbXMsXHJcblx0XHRcdGxhc3RJdGVtID0gZmlyc3RJdGVtICsgYW1vdW50UGFnZUl0ZW1zO1xyXG5cdFx0cmV0dXJuIGl0ZW1zLnNsaWNlKGZpcnN0SXRlbSwgbGFzdEl0ZW0pO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuc2V0QWN0aXZlUGFnZSA9IGZ1bmN0aW9uKG51bWJlcikge1xyXG5cdFx0bnVtYmVyQWN0aXZlUGFnZSA9IG51bWJlcjtcclxuXHRcdGdvb2RzLmxvYWRHb29kcygpO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuYWRkUGFnaW5nR2V0SXRlbXNJblBhZ2UgPSBmdW5jdGlvbihpdGVtcykge1xyXG5cdFx0YWRkQ29udGVudFRvQ29udGFpbmVyKCcuanMtcGFnaW5hdGlvbicsIGdldFBCdXR0b25zQ29udGVudChpdGVtcykpO1xyXG5cdFx0cmV0dXJuIGdldEl0ZW1zSW5BY3RpdmVQYWdlKGl0ZW1zKTtcclxuXHR9O1xyXG59XHJcblxyXG4vL9C60L7RgNC30LjQvdCwXHJcbmZ1bmN0aW9uIEJhc2tldFNldHRpbmcoKSB7XHJcblx0bGV0IGdvb2RzSW5CYXNrZXQgPSBbXTtcclxuXHJcblx0Y29uc3QgZ2V0R29vZENvbnRlbnQgPSBnb29kID0+IHtcclxuXHRcdGxldCB7IGlkLCBpbWFnZSwgdGl0bGUsIGNvdW50IH0gPSBnb29kO1xyXG5cdFx0cmV0dXJuIGA8ZGl2IGNsYXNzPVwiYmFza2V0X19nb29kLWl0ZW1cIiBkYXRhLWItZ29vZC1pZD1cIiR7aWR9XCI+XHJcblx0XHRcdDxidXR0b24gY2xhc3M9XCJiYXNrZXRfX2dvb2QtcmVtb3ZlIGpzLXJlbW92ZS1nb29kXCI+JiMxMjg5Mzg7PC9idXR0b24+XHJcblx0XHRcdDxkaXYgY2xhc3M9XCJiYXNrZXRfX2dvb2QtaW1hZ2VcIj48aW1nIHNyYz1cIiR7aW1hZ2V9XCIvPjwvZGl2PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzPVwiYmFza2V0X19nb29kLW5hbWVcIj4ke3RpdGxlfTwvZGl2PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzPVwiYmFza2V0X19nb29kLWFtb3V0XCI+JHtjb3VudH08L2Rpdj5cclxuXHRcdDwvZGl2PmA7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgYWRkR29vZFRvQ29udGFpbmVyID0gKCkgPT4ge1xyXG5cdFx0bGV0IGdvb2RzQ29udGVudCA9IGdvb2RzSW5CYXNrZXQubWFwKGdvb2QgPT4gZ2V0R29vZENvbnRlbnQoZ29vZCkpLmpvaW4oJycpO1xyXG5cdFx0YWRkQ29udGVudFRvQ29udGFpbmVyKCcuanMtYmFza2V0LWdvb2QnLCBnb29kc0NvbnRlbnQpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGZpbmRHb29kQW5kUmVtb3ZlID0gaWQgPT4ge1xyXG5cdFx0bGV0IGluZGV4ID0gZ29vZHNJbkJhc2tldC5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLmlkID09PSAraWQpO1xyXG5cdFx0Z29vZHNJbkJhc2tldC5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGZpbmRHb29kQW5kQWRkID0gZ29vZCA9PiB7XHJcblx0XHRsZXQgZ29vZEluQmFza2V0ID0gZ29vZHNJbkJhc2tldC5maW5kKGl0ZW0gPT4gaXRlbS5pZCA9PT0gZ29vZC5pZCk7XHJcblx0XHRpZiAoZ29vZEluQmFza2V0KSB7XHJcblx0XHRcdGdvb2RJbkJhc2tldC5jb3VudCsrO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Z29vZC5jb3VudCA9IDE7XHJcblx0XHRcdGdvb2RzSW5CYXNrZXQgPSBbLi4uZ29vZHNJbkJhc2tldCwgZ29vZF07XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0Y29uc3QgY291bnRUb3RhbENvc3QgPSAoKSA9PiB7XHJcblx0XHRsZXQgdG90YWxDb3N0ID0gZ29vZHNJbkJhc2tldC5yZWR1Y2UoZnVuY3Rpb24oc3VtLCBpdGVtKSB7XHJcblx0XHRcdHJldHVybiBzdW0gKyBpdGVtLmNvdW50ICogaXRlbS5wcmljZTtcclxuXHRcdH0sIDApO1xyXG5cdFx0YWRkQ29udGVudFRvQ29udGFpbmVyKCcuanMtY291bnQtcmVzdWx0JywgdG90YWxDb3N0KTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBzYXZlVG9Mb2NhbFN0b3JhZ2UgPSAoKSA9PiB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuZ29vZHNJbkJhc2tldCA9IEpTT04uc3RyaW5naWZ5KGdvb2RzSW5CYXNrZXQpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGNvdW50R29vZHNJbkJhc2tldCA9ICgpID0+IHtcclxuXHRcdHJldHVybiBnb29kc0luQmFza2V0LnJlZHVjZShmdW5jdGlvbihzdW0sIGl0ZW0pIHtcclxuXHRcdFx0cmV0dXJuIHN1bSArIGl0ZW0uY291bnQ7XHJcblx0XHR9LCAwKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCByZWxvYWRCYXNrZXQgPSAoKSA9PiB7XHJcblx0XHRzYXZlVG9Mb2NhbFN0b3JhZ2UoKTtcclxuXHRcdGFkZEdvb2RUb0NvbnRhaW5lcigpO1xyXG5cdFx0Y291bnRUb3RhbENvc3QoKTtcclxuXHR9O1xyXG5cclxuXHR0aGlzLmdldExvY2FsU29yYWdlID0gZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2dvb2RzSW5CYXNrZXQnKSAhPSBudWxsKVxyXG5cdFx0XHRnb29kc0luQmFza2V0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZ29vZHNJbkJhc2tldCcpKTtcclxuXHRcdGFkZEdvb2RUb0NvbnRhaW5lcigpO1xyXG5cdFx0Y291bnRUb3RhbENvc3QoKTtcclxuXHR9O1xyXG5cclxuXHR0aGlzLmdldENvdW50R29vZHNJbkJhc2tldCA9ICgpID0+IHtcclxuXHRcdGFkZENvbnRlbnRUb0NvbnRhaW5lcignLmpzLWdvb2QtaW4tYmFza2V0JywgY291bnRHb29kc0luQmFza2V0KCkpO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuYWRkR29vZFRvQmFza2V0ID0gZ29vZCA9PiB7XHJcblx0XHRmaW5kR29vZEFuZEFkZChnb29kKTtcclxuXHRcdHJlbG9hZEJhc2tldCgpO1xyXG5cdH07XHJcblxyXG5cdHRoaXMucmVtb3ZlR29vZEZyb21CYXNrZXQgPSBpZCA9PiB7XHJcblx0XHRmaW5kR29vZEFuZFJlbW92ZShpZCk7XHJcblx0XHRyZWxvYWRCYXNrZXQoKTtcclxuXHR9O1xyXG59XHJcbiJdfQ==
