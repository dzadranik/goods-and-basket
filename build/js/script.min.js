"use strict";var _basketSetting=basketSetting(),addGoodToBasket=_basketSetting.addGoodToBasket,getLocalSorage=_basketSetting.getLocalSorage,removeGoodFromBasket=_basketSetting.removeGoodFromBasket,countGoodInBasket=_basketSetting.countGoodInBasket,_paging=paging(),addPaging=_paging.addPaging,setActivePage=_paging.setActivePage,_goodSetting=goodSetting(),loadGoodToPage=_goodSetting.loadGoodToPage,setAvaliable=_goodSetting.setAvaliable,setSorting=_goodSetting.setSorting,returnGoodData=_goodSetting.returnGoodData,_containerClassSettin=containerClassSetting(),findContainerAndRemoveClass=_containerClassSettin.findContainerAndRemoveClass;function addToContainer(t,n){var o=document.querySelector(t);o&&(o.innerHTML=n)}function addToAnyContainers(t,n){var o=document.querySelectorAll(t);if(o)for(var e=0;e<o.length;e++)o[e].innerHTML=n}function containerClassSetting(){var t,n;return{findContainerAndRemoveClass:function(o,e){t=document.querySelectorAll(o),n=e,function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e<t.length)return t[e].classList.remove(n),o(e+1)}()}}}function get(t){return new Promise((function(n,o){var e=new XMLHttpRequest;e.open("GET",t,!0),e.addEventListener("load",(function(){e.status<400?n(e.response):o(new Error("Request failed: "+e.statusText))})),e.addEventListener("error",(function(){o(new Error("Network error"))})),e.send()}))}function goodSetting(){var t=[],n=!1,o="sorting-name";return{loadGoodToPage:function(){get("js/goods.json").then((function(t){return JSON.parse(t)})).then((function(t){return function(t){var e=t;return n&&(e=function(t){return t.filter((function(t){return t.avaliable}))}(t)),"sorting-cost"==o?e=function(t){return t.sort((function(t,n){return t.price-n.price}))}(e):"sorting-name"==o&&(e=function(t){return t.sort((function(t,n){var o=t.title.toLowerCase(),e=n.title.toLowerCase();return o<e?-1:o<e?1:void 0}))}(e)),e}(t)})).then((function(t){return addPaging(t)})).then((function(n){!function(n){t=n;var o=n.map((function(t){return function(t){var n=t.id,o=t.image,e=t.title,a=t.price,i=t.descr;return'<div class="good__item" good-id='.concat(n,'>\n\t\t\t\t\t<div class="good__image"><img src="').concat(o,'"/></div>\n\t\t\t\t\t<div class="good__information">\n\t\t\t\t\t\t<div class="good__title">').concat(e,'</div>\n\t\t\t\t\t\t<div class="good__price">').concat(a,' руб</div>\n\t\t\t\t\t\t<div class="good__description">').concat(i,'</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="good__transaction">\n\t\t\t\t\t\t<button class="good__button">Добавить в корзину</button>\n\t\t\t\t\t\t<div class="good__basket-feedback js-good-in-basket"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>')}(t)}));addToContainer(".js-good",o=o.join(""))}(n),countGoodInBasket()})).catch()},setAvaliable:function(t){n=t,setActivePage(0),loadGoodToPage()},setSorting:function(t){o!=t&&(o=t,loadGoodToPage())},returnGoodData:function(n){return t.find((function(t){return t.id==n}))}}}function paging(){var t=0,n=function(n){return'<button \n\t\t\tclass="pagination__item js-pagination-button '.concat(n==t?"active":"",'" \n\t\t\tid="').concat(n+1,'">\n\t\t\t\t').concat(n+1,"\n\t\t\t</button>")},o=function(t,o){for(var e="",a=t;a<o;a++)e+=n(a);return e};return{setActivePage:function(n){t=n,loadGoodToPage()},addPaging:function(n){return addToContainer(".js-pagination",function(n){var e=n.length,a=Math.ceil(e/15),i="";return a>6?t<2||t>a-3?(i+=o(0,3),i+="<span class='pagination__dots'>...</span>",i+=o(a-3,a)):2==t?(i+=o(0,4),i+="<span class='pagination__dots'>...</span>",i+=o(a-1,a)):t==a-3?(i+=o(0,1),i+="<span class='pagination__dots'>...</span>",i+=o(a-4,a)):t>2&&t<a-3&&(i+=o(0,1),i+="<span class='pagination__dots'>...</span>",i+=o(t-1,t+2),i+="<span class='pagination__dots'>...</span>",i+=o(a-1,a)):i+=o(0,a),i}(n)),function(n){var o=15*t,e=o+15;return n.slice(o,e)}(n)}}}function basketSetting(){var t=[],n=function(){localStorage.goodInBasket=JSON.stringify(t),addToContainer(".js-basket-good",t.map((function(t){return o=(n=t).id,e=n.image,a=n.title,i=n.count,'<div class="basket__good-item" basket-good-id="'.concat(o,'">\n\t\t\t<button class="basket__good-remove js-remove-good">&#128938;</button>\n\t\t\t<div class="basket__good-image"><img src="').concat(e,'" /></div>\n\t\t\t<div class="basket__good-name">').concat(a,'</div>\n\t\t\t<div class="basket__good-amout">').concat(i,"</div>\n\t\t</div>");var n,o,e,a,i})).join("")),addToContainer(".js-count-result",t.reduce((function(t,n){return t+n.count*n.price}),0)),countGoodInBasket()};return{getLocalSorage:function(){null!=localStorage.getItem("goodInBasket")&&(t=JSON.parse(localStorage.getItem("goodInBasket"))),n()},countGoodInBasket:function(){var n=t.reduce((function(t,n){return t+n.count}),0);addToAnyContainers(".js-good-in-basket","Товаров в корзине  ".concat(n))},addGoodToBasket:function(o){for(var e=0;e<t.length;e++)if(o.id==t[e].id)return t[e].count++,void n();o.count=1,t.push(o),n()},removeGoodFromBasket:function(o){!function n(o){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e<t.length||o!==t[e].id?t.splice(e,1):n(e++)}(o),n()}}}document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelector(".js-pagination"),n=document.querySelector(".js-sorting-buttons"),o=document.getElementById("avaliable"),e=document.querySelector(".js-good"),a=document.querySelector(".js-basket-good");t.addEventListener("click",(function(t){var n=t.target;n.classList.contains("js-pagination-button")&&!n.classList.contains("active")&&setActivePage(n.getAttribute("id")-1)})),n.addEventListener("click",(function(t){var n=t.target,o=n.getAttribute("sorting-setting");n.classList.contains("js-sorting")&&!n.classList.contains("active")&&(findContainerAndRemoveClass(".js-sorting","active"),setSorting(o),n.classList.add("active"))})),o.addEventListener("change",(function(t){setAvaliable(t.target.checked)})),e.addEventListener("click",(function(t){if(t.target.classList.contains("good__button")){var n=t.target.parentElement.parentElement.getAttribute("good-id"),o=returnGoodData(n);addGoodToBasket(o)}})),a.addEventListener("click",(function(t){var n=t.target;if(n.classList.contains("js-remove-good")){var o=n.parentElement.getAttribute("basket-good-id");removeGoodFromBasket(o)}}))})),loadGoodToPage(),getLocalSorage();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJfYmFza2V0U2V0dGluZyIsImJhc2tldFNldHRpbmciLCJhZGRHb29kVG9CYXNrZXQiLCJnZXRMb2NhbFNvcmFnZSIsInJlbW92ZUdvb2RGcm9tQmFza2V0IiwiY291bnRHb29kSW5CYXNrZXQiLCJfcGFnaW5nIiwicGFnaW5nIiwiYWRkUGFnaW5nIiwic2V0QWN0aXZlUGFnZSIsIl9nb29kU2V0dGluZyIsImdvb2RTZXR0aW5nIiwibG9hZEdvb2RUb1BhZ2UiLCJzZXRBdmFsaWFibGUiLCJzZXRTb3J0aW5nIiwicmV0dXJuR29vZERhdGEiLCJfY29udGFpbmVyQ2xhc3NTZXR0aW4iLCJjb250YWluZXJDbGFzc1NldHRpbmciLCJmaW5kQ29udGFpbmVyQW5kUmVtb3ZlQ2xhc3MiLCJhZGRUb0NvbnRhaW5lciIsImNvbnRhaW5lckNsYXNzIiwiZWxlbWVudCIsImNvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsImFkZFRvQW55Q29udGFpbmVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpIiwibGVuZ3RoIiwiYWxsQ29udGFpbmVyIiwiY2xhc3NUb1JlbW92ZSIsImNsYXNzTmFtZSIsInJlbW92ZUNsYXNzSW5Db250YWluZXIiLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJnZXQiLCJ1cmwiLCJQcm9taXNlIiwic3VjY2VlZCIsImZhaWwiLCJyZXF1ZXN0IiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0YXR1cyIsInJlc3BvbnNlIiwiRXJyb3IiLCJzdGF0dXNUZXh0Iiwic2VuZCIsImdvb2REYXRhIiwiYXZhbGlhYmxlIiwic29ydGluZ1ZhbHVlIiwidGhlbiIsIkpTT04iLCJwYXJzZSIsImRhdGEiLCJpdGVtIiwiZmlsdGVyIiwiZWxlbSIsInNvcnRpbmdBdmFsaWFibGUiLCJzb3J0IiwicHJldiIsIm5leHQiLCJwcmljZSIsInNvcnRpbmdCeUNvc3QiLCJ4IiwidGl0bGUiLCJ0b0xvd2VyQ2FzZSIsInkiLCJzb3J0aW5nQnlOYW1lIiwic29ydGluZyIsImdvb2RJdGVtcyIsIm1hcCIsImlkIiwiaW1hZ2UiLCJkZXNjciIsImNvbmNhdCIsInJldHVybkdvb2RJdGVtIiwiam9pbiIsImFkZEdvb2RUb0NvbnRhaW5lciIsInZhbHVlIiwiZmluZCIsImFjdGl2ZVBhZ2UiLCJyZXR1cm5QYWdpbmdCdXR0b24iLCJyZXR1cm5BbnlQYWdpbmdCdXR0b25zIiwiZnJzdCIsImxhc3QiLCJwYWdpbmdCdXR0b25zIiwiYW1vdW50SXRlbSIsImFtb3VudEJ1dHRvbiIsIk1hdGgiLCJjZWlsIiwicmV0dXJuUGFnaW5nQnV0dG9ucyIsImZpcnN0SXRlbSIsImxhc3RJdGVtIiwic2xpY2UiLCJyZXR1cm5JdGVtSW5BY3RpdmVQYWdlIiwiZ29vZEluQmFza2V0IiwicmVsb2FkQmFza2V0IiwibG9jYWxTdG9yYWdlIiwic3RyaW5naWZ5IiwiY291bnQiLCJyZWR1Y2UiLCJzdW0iLCJnZXRJdGVtIiwicHVzaCIsImZpbmRHb29kQW5kUmVtb3ZlIiwic3BsaWNlIiwicGFnaW5hdGlvbkJ1dHRvbkNvbnRhaW5lciIsInNvcnRpbmdCdXR0b25Db250YWluZXIiLCJhdmFsaWFibGVDaGVja2JveCIsImdldEVsZW1lbnRCeUlkIiwiZ29vZENvbnRhaW5lciIsImJhc2tldEdvb2RDb250YWluZXIiLCJldmVudCIsInRhcmdldEVsZW1lbnQiLCJ0YXJnZXQiLCJjb250YWlucyIsImdldEF0dHJpYnV0ZSIsInNvcnRpbmdTZXR0aW5nIiwiYWRkIiwiY2hlY2tlZCIsImdvb2RJZCIsInBhcmVudEVsZW1lbnQiXSwibWFwcGluZ3MiOiJBQUFBLGFBRUEsSUFBSUEsZUFGK0VDLGdCQUE3RUMsZ0JBR2dCRixlQUhoQkUsZ0JBQWlCQyxlQUlGSCxlQUpFRyxlQUFnQkMscUJBS1pKLGVBTFlJLHFCQUFzQkMsa0JBTXJDTCxlQU5xQ0ssa0JBT3pE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LEVBQWNsRixVQUFVb0YsU0FBUywwQkFBNEJGLEVBQWNsRixVQUFVb0YsU0FBUyxXQUNqRy9HLGNBQWM2RyxFQUFjRyxhQUFhLE1BQVEsTUFLbkRULEVBQXVCbEUsaUJBQWlCLFNBQVMsU0FBQXVFLEdBQ2hELElBQU1DLEVBQWdCRCxFQUFNRSxPQUMzQkcsRUFBaUJKLEVBQWNHLGFBQWEsbUJBQ3pDSCxFQUFjbEYsVUFBVW9GLFNBQVMsZ0JBQWtCRixFQUFjbEYsVUFBVW9GLFNBQVMsWUFDdkZ0Ryw0QkFBNEIsY0FBZSxVQUMzQ0osV0FBVzRHLEdBQ1hKLEVBQWNsRixVQUFVdUYsSUFBSSxjQUs5QlYsRUFBa0JuRSxpQkFBaUIsVUFBVSxTQUFBdUUsR0FDNUN4RyxhQUFhd0csRUFBTUUsT0FBT0ssWUFJM0JULEVBQWNyRSxpQkFBaUIsU0FBUyxTQUFBdUUsR0FDdkMsR0FBSUEsRUFBTUUsT0FBT25GLFVBQVVvRixTQUFTLGdCQUFpQixDQUNwRCxJQUFJSyxFQUFTUixFQUFNRSxPQUFPTyxjQUFjQSxjQUFjTCxhQUFhLFdBQy9EckUsRUFBV3JDLGVBQWU4RyxHQUM5QjNILGdCQUFnQmtELE9BS2xCZ0UsRUFBb0J0RSxpQkFBaUIsU0FBUyxTQUFBdUUsR0FDN0MsSUFBTUMsRUFBZ0JELEVBQU1FLE9BQzVCLEdBQUlELEVBQWNsRixVQUFVb0YsU0FBUyxrQkFBbUIsQ0FDdkQsSUFBSUssRUFBU1AsRUFBY1EsY0FBY0wsYUFBYSxrQkFDdERySCxxQkFBcUJ5SCxVQUt4QmpILGlCQUNBVCIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgeyBhZGRHb29kVG9CYXNrZXQsIGdldExvY2FsU29yYWdlLCByZW1vdmVHb29kRnJvbUJhc2tldCwgY291bnRHb29kSW5CYXNrZXQgfSA9IGJhc2tldFNldHRpbmcoKSxcclxuXHR7IGFkZFBhZ2luZywgc2V0QWN0aXZlUGFnZSB9ID0gcGFnaW5nKCksXHJcblx0eyBsb2FkR29vZFRvUGFnZSwgc2V0QXZhbGlhYmxlLCBzZXRTb3J0aW5nLCByZXR1cm5Hb29kRGF0YSB9ID0gZ29vZFNldHRpbmcoKSxcclxuXHR7IGZpbmRDb250YWluZXJBbmRSZW1vdmVDbGFzcyB9ID0gY29udGFpbmVyQ2xhc3NTZXR0aW5nKClcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcclxuXHRjb25zdCBwYWdpbmF0aW9uQnV0dG9uQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLXBhZ2luYXRpb24nKSxcclxuXHRcdHNvcnRpbmdCdXR0b25Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtc29ydGluZy1idXR0b25zJyksXHJcblx0XHRhdmFsaWFibGVDaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdmFsaWFibGUnKSxcclxuXHRcdGdvb2RDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtZ29vZCcpLFxyXG5cdFx0YmFza2V0R29vZENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1iYXNrZXQtZ29vZCcpXHJcblxyXG5cdC8v0YHQu9GD0YjQsNC70LrQsCDQutC90L7Qv9C+0Log0L/QsNCz0LjQvdCw0YLQvtGA0LBcclxuXHRwYWdpbmF0aW9uQnV0dG9uQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0Y29uc3QgdGFyZ2V0RWxlbWVudCA9IGV2ZW50LnRhcmdldFxyXG5cdFx0aWYgKHRhcmdldEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1wYWdpbmF0aW9uLWJ1dHRvbicpICYmICF0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcclxuXHRcdFx0c2V0QWN0aXZlUGFnZSh0YXJnZXRFbGVtZW50LmdldEF0dHJpYnV0ZSgnaWQnKSAtIDEpXHJcblx0XHR9XHJcblx0fSlcclxuXHJcblx0Ly8g0YHQu9GD0YjQsNC70LrQsCDRgdC+0YDRgtC40YDQvtCy0L7QulxyXG5cdHNvcnRpbmdCdXR0b25Db250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudCA9PiB7XHJcblx0XHRjb25zdCB0YXJnZXRFbGVtZW50ID0gZXZlbnQudGFyZ2V0LFxyXG5cdFx0XHRzb3J0aW5nU2V0dGluZyA9IHRhcmdldEVsZW1lbnQuZ2V0QXR0cmlidXRlKCdzb3J0aW5nLXNldHRpbmcnKVxyXG5cdFx0aWYgKHRhcmdldEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1zb3J0aW5nJykgJiYgIXRhcmdldEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkge1xyXG5cdFx0XHRmaW5kQ29udGFpbmVyQW5kUmVtb3ZlQ2xhc3MoJy5qcy1zb3J0aW5nJywgJ2FjdGl2ZScpXHJcblx0XHRcdHNldFNvcnRpbmcoc29ydGluZ1NldHRpbmcpXHJcblx0XHRcdHRhcmdldEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcclxuXHRcdH1cclxuXHR9KVxyXG5cclxuXHQvLyDRgdC70YPRiNCw0LvQutCwINGB0L7RgNGC0LjRgNC+0LLQutC4INC/0L4g0L3QsNC70LjRh9C40Y5cclxuXHRhdmFsaWFibGVDaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBldmVudCA9PiB7XHJcblx0XHRzZXRBdmFsaWFibGUoZXZlbnQudGFyZ2V0LmNoZWNrZWQpXHJcblx0fSlcclxuXHJcblx0Ly8g0LrQvdC+0L/QutCwINC00L7QsdCw0LLQuNGC0Ywg0LIg0LrQvtGA0LfQuNC90YNcclxuXHRnb29kQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0aWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2dvb2RfX2J1dHRvbicpKSB7XHJcblx0XHRcdGxldCBnb29kSWQgPSBldmVudC50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZ29vZC1pZCcpXHJcblx0XHRcdGxldCBnb29kRGF0YSA9IHJldHVybkdvb2REYXRhKGdvb2RJZClcclxuXHRcdFx0YWRkR29vZFRvQmFza2V0KGdvb2REYXRhKVxyXG5cdFx0fVxyXG5cdH0pXHJcblxyXG5cdC8vINC60L3QvtC/0LrQsCDRg9C00LDQu9C40YLRjCDQuNC3INC60L7RgNC30LjQvdGLXHJcblx0YmFza2V0R29vZENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50ID0+IHtcclxuXHRcdGNvbnN0IHRhcmdldEVsZW1lbnQgPSBldmVudC50YXJnZXRcclxuXHRcdGlmICh0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanMtcmVtb3ZlLWdvb2QnKSkge1xyXG5cdFx0XHRsZXQgZ29vZElkID0gdGFyZ2V0RWxlbWVudC5wYXJlbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnYmFza2V0LWdvb2QtaWQnKVxyXG5cdFx0XHRyZW1vdmVHb29kRnJvbUJhc2tldChnb29kSWQpXHJcblx0XHR9XHJcblx0fSlcclxufSlcclxuXHJcbmxvYWRHb29kVG9QYWdlKClcclxuZ2V0TG9jYWxTb3JhZ2UoKVxyXG5cclxuLy/QlNC+0LHQsNCy0LvQtdC90LjQtSDRjdC70LXQvNC10L3RgtC+0LIg0LIg0LrQvtC90YLQtdC50L3QtdGAXHJcbmZ1bmN0aW9uIGFkZFRvQ29udGFpbmVyKGNvbnRhaW5lckNsYXNzLCBlbGVtZW50KSB7XHJcblx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJDbGFzcylcclxuXHRpZiAoY29udGFpbmVyKSBjb250YWluZXIuaW5uZXJIVE1MID0gZWxlbWVudFxyXG59XHJcbmZ1bmN0aW9uIGFkZFRvQW55Q29udGFpbmVycyhjb250YWluZXJDbGFzcywgZWxlbWVudCkge1xyXG5cdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29udGFpbmVyQ2xhc3MpXHJcblx0aWYgKGNvbnRhaW5lcikge1xyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjb250YWluZXIubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0Y29udGFpbmVyW2ldLmlubmVySFRNTCA9IGVsZW1lbnRcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbi8v0YPQtNCw0LvQuNGC0Ywg0LrQu9Cw0YHRgSDRgyDQs9GA0YPQv9C/0Ysg0LrQvtC90YLQtdC50L3QtdGA0L7QslxyXG5mdW5jdGlvbiBjb250YWluZXJDbGFzc1NldHRpbmcoKSB7XHJcblx0dmFyIGFsbENvbnRhaW5lciwgY2xhc3NUb1JlbW92ZVxyXG5cdGNvbnN0IHJlbW92ZUNsYXNzSW5Db250YWluZXIgPSAoaSA9IDApID0+IHtcclxuXHRcdGlmIChpIDwgYWxsQ29udGFpbmVyLmxlbmd0aCkge1xyXG5cdFx0XHRhbGxDb250YWluZXJbaV0uY2xhc3NMaXN0LnJlbW92ZShjbGFzc1RvUmVtb3ZlKVxyXG5cdFx0XHRyZXR1cm4gcmVtb3ZlQ2xhc3NJbkNvbnRhaW5lcihpICsgMSlcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIHtcclxuXHRcdGZpbmRDb250YWluZXJBbmRSZW1vdmVDbGFzczogKGNvbnRhaW5lciwgY2xhc3NOYW1lKSA9PiB7XHJcblx0XHRcdGFsbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29udGFpbmVyKVxyXG5cdFx0XHRjbGFzc1RvUmVtb3ZlID0gY2xhc3NOYW1lXHJcblx0XHRcdHJlbW92ZUNsYXNzSW5Db250YWluZXIoKVxyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuLy8g0L/QvtC70YPRh9C10L3QuNC1INC00LDQvdC90YvRhVxyXG5mdW5jdGlvbiBnZXQodXJsKSB7XHJcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHN1Y2NlZWQsIGZhaWwpIHtcclxuXHRcdGxldCByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KClcclxuXHRcdHJlcXVlc3Qub3BlbignR0VUJywgdXJsLCB0cnVlKVxyXG5cdFx0cmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmIChyZXF1ZXN0LnN0YXR1cyA8IDQwMCkgc3VjY2VlZChyZXF1ZXN0LnJlc3BvbnNlKVxyXG5cdFx0XHRlbHNlIGZhaWwobmV3IEVycm9yKCdSZXF1ZXN0IGZhaWxlZDogJyArIHJlcXVlc3Quc3RhdHVzVGV4dCkpXHJcblx0XHR9KVxyXG5cdFx0cmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRmYWlsKG5ldyBFcnJvcignTmV0d29yayBlcnJvcicpKVxyXG5cdFx0fSlcclxuXHRcdHJlcXVlc3Quc2VuZCgpXHJcblx0fSlcclxufVxyXG5cclxuLy8g0YLQvtCy0LDRgNGLXHJcbmZ1bmN0aW9uIGdvb2RTZXR0aW5nKCkge1xyXG5cdHZhciBnb29kRGF0YSA9IFtdLFxyXG5cdFx0YXZhbGlhYmxlID0gZmFsc2UsXHJcblx0XHRzb3J0aW5nVmFsdWUgPSAnc29ydGluZy1uYW1lJ1xyXG5cclxuXHRjb25zdCBzb3J0aW5nQXZhbGlhYmxlID0gZGF0YSA9PiB7XHJcblx0XHRyZXR1cm4gZGF0YS5maWx0ZXIoZWxlbSA9PiBlbGVtLmF2YWxpYWJsZSlcclxuXHR9XHJcblxyXG5cdGNvbnN0IHNvcnRpbmdCeUNvc3QgPSBkYXRhID0+IHtcclxuXHRcdHJldHVybiBkYXRhLnNvcnQoKHByZXYsIG5leHQpID0+IHByZXYucHJpY2UgLSBuZXh0LnByaWNlKVxyXG5cdH1cclxuXHJcblx0Y29uc3Qgc29ydGluZ0J5TmFtZSA9IGRhdGEgPT4ge1xyXG5cdFx0cmV0dXJuIGRhdGEuc29ydCgocHJldiwgbmV4dCkgPT4ge1xyXG5cdFx0XHRjb25zdCB4ID0gcHJldi50aXRsZS50b0xvd2VyQ2FzZSgpXHJcblx0XHRcdGNvbnN0IHkgPSBuZXh0LnRpdGxlLnRvTG93ZXJDYXNlKClcclxuXHRcdFx0aWYgKHggPCB5KSByZXR1cm4gLTFcclxuXHRcdFx0aWYgKHggPCB5KSByZXR1cm4gMVxyXG5cdFx0fSlcclxuXHR9XHJcblxyXG5cdGNvbnN0IHNvcnRpbmcgPSBkYXRhID0+IHtcclxuXHRcdGxldCBpdGVtID0gZGF0YVxyXG5cdFx0aWYgKGF2YWxpYWJsZSkgaXRlbSA9IHNvcnRpbmdBdmFsaWFibGUoZGF0YSlcclxuXHJcblx0XHRpZiAoc29ydGluZ1ZhbHVlID09ICdzb3J0aW5nLWNvc3QnKSBpdGVtID0gc29ydGluZ0J5Q29zdChpdGVtKVxyXG5cdFx0ZWxzZSBpZiAoc29ydGluZ1ZhbHVlID09ICdzb3J0aW5nLW5hbWUnKSBpdGVtID0gc29ydGluZ0J5TmFtZShpdGVtKVxyXG5cdFx0cmV0dXJuIGl0ZW1cclxuXHR9XHJcblxyXG5cdGNvbnN0IHJldHVybkdvb2RJdGVtID0gZGF0YSA9PiB7XHJcblx0XHRsZXQgeyBpZCwgaW1hZ2UsIHRpdGxlLCBwcmljZSwgZGVzY3IgfSA9IGRhdGFcclxuXHRcdHJldHVybiBgPGRpdiBjbGFzcz1cImdvb2RfX2l0ZW1cIiBnb29kLWlkPSR7aWR9PlxyXG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX2ltYWdlXCI+PGltZyBzcmM9XCIke2ltYWdlfVwiLz48L2Rpdj5cclxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJnb29kX19pbmZvcm1hdGlvblwiPlxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9fdGl0bGVcIj4ke3RpdGxlfTwvZGl2PlxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9fcHJpY2VcIj4ke3ByaWNlfSDRgNGD0LE8L2Rpdj5cclxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX2Rlc2NyaXB0aW9uXCI+JHtkZXNjcn08L2Rpdj5cclxuXHRcdFx0XHRcdDwvZGl2PlxyXG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX3RyYW5zYWN0aW9uXCI+XHJcblx0XHRcdFx0XHRcdDxidXR0b24gY2xhc3M9XCJnb29kX19idXR0b25cIj7QlNC+0LHQsNCy0LjRgtGMINCyINC60L7RgNC30LjQvdGDPC9idXR0b24+XHJcblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJnb29kX19iYXNrZXQtZmVlZGJhY2sganMtZ29vZC1pbi1iYXNrZXRcIj48L2Rpdj5cclxuXHRcdFx0XHRcdDwvZGl2PlxyXG5cdFx0XHRcdDwvZGl2PmBcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGFkZEdvb2RUb0NvbnRhaW5lcihkYXRhKSB7XHJcblx0XHRnb29kRGF0YSA9IGRhdGFcclxuXHRcdGxldCBnb29kSXRlbXMgPSBkYXRhLm1hcChpdGVtID0+IHJldHVybkdvb2RJdGVtKGl0ZW0pKVxyXG5cdFx0Z29vZEl0ZW1zID0gZ29vZEl0ZW1zLmpvaW4oJycpXHJcblx0XHRhZGRUb0NvbnRhaW5lcignLmpzLWdvb2QnLCBnb29kSXRlbXMpXHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0bG9hZEdvb2RUb1BhZ2U6ICgpID0+IHtcclxuXHRcdFx0Z2V0KCdqcy9nb29kcy5qc29uJylcclxuXHRcdFx0XHQudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIEpTT04ucGFyc2UocmVzcG9uc2UpXHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gc29ydGluZyhkYXRhKVxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdFx0LnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGFkZFBhZ2luZyhkYXRhKVxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdFx0LnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0YWRkR29vZFRvQ29udGFpbmVyKGRhdGEpXHJcblx0XHRcdFx0XHRjb3VudEdvb2RJbkJhc2tldCgpXHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQuY2F0Y2goKVxyXG5cdFx0fSxcclxuXHRcdHNldEF2YWxpYWJsZTogdmFsdWUgPT4ge1xyXG5cdFx0XHRhdmFsaWFibGUgPSB2YWx1ZVxyXG5cdFx0XHRzZXRBY3RpdmVQYWdlKDApXHJcblx0XHRcdGxvYWRHb29kVG9QYWdlKClcclxuXHRcdH0sXHJcblx0XHRzZXRTb3J0aW5nOiB2YWx1ZSA9PiB7XHJcblx0XHRcdGlmIChzb3J0aW5nVmFsdWUgIT0gdmFsdWUpIHtcclxuXHRcdFx0XHRzb3J0aW5nVmFsdWUgPSB2YWx1ZVxyXG5cdFx0XHRcdGxvYWRHb29kVG9QYWdlKClcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdHJldHVybkdvb2REYXRhOiBpZCA9PiB7XHJcblx0XHRcdHJldHVybiBnb29kRGF0YS5maW5kKGl0ZW0gPT4gaXRlbS5pZCA9PSBpZClcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbi8v0L/QsNCz0LjQvdCw0YbQuNGPXHJcbmZ1bmN0aW9uIHBhZ2luZygpIHtcclxuXHRjb25zdCBpdGVtSW5QYWdlID0gMTUgLy8g0LrQvtC70LjRh9C10YHRgtCy0L4g0Y3Qu9C10LzQtdC90YLQvtCyINC90LAg0YHRgtGA0LDQvdC40YbQtVxyXG5cdHZhciBhY3RpdmVQYWdlID0gMCAvLyDQsNC60YLQuNCy0L3QsNGPINGB0YLRgNCw0L3QuNGG0LBcclxuXHJcblx0Y29uc3QgcmV0dXJuUGFnaW5nQnV0dG9uID0gaSA9PiB7XHJcblx0XHRyZXR1cm4gYDxidXR0b24gXHJcblx0XHRcdGNsYXNzPVwicGFnaW5hdGlvbl9faXRlbSBqcy1wYWdpbmF0aW9uLWJ1dHRvbiAke2kgPT0gYWN0aXZlUGFnZSA/ICdhY3RpdmUnIDogJyd9XCIgXHJcblx0XHRcdGlkPVwiJHtpICsgMX1cIj5cclxuXHRcdFx0XHQke2kgKyAxfVxyXG5cdFx0XHQ8L2J1dHRvbj5gXHJcblx0fVxyXG5cclxuXHRjb25zdCByZXR1cm5QYWdpbmdEb3RzID0gKCkgPT4ge1xyXG5cdFx0cmV0dXJuIGA8c3BhbiBjbGFzcz0ncGFnaW5hdGlvbl9fZG90cyc+Li4uPC9zcGFuPmBcclxuXHR9XHJcblxyXG5cdGNvbnN0IHJldHVybkFueVBhZ2luZ0J1dHRvbnMgPSAoZnJzdCwgbGFzdCkgPT4ge1xyXG5cdFx0bGV0IHBhZ2luZ0J1dHRvbnMgPSAnJ1xyXG5cdFx0Zm9yIChsZXQgaSA9IGZyc3Q7IGkgPCBsYXN0OyBpKyspIHtcclxuXHRcdFx0cGFnaW5nQnV0dG9ucyArPSByZXR1cm5QYWdpbmdCdXR0b24oaSlcclxuXHRcdH1cclxuXHRcdHJldHVybiBwYWdpbmdCdXR0b25zXHJcblx0fVxyXG5cclxuXHRjb25zdCByZXR1cm5QYWdpbmdCdXR0b25zID0gZGF0YSA9PiB7XHJcblx0XHR2YXIgaXRlbSA9IGRhdGEsIC8vINC80LDRgdGB0LjQsiDRgtC+0LLQsNGA0L7QslxyXG5cdFx0XHRhbW91bnRJdGVtID0gaXRlbS5sZW5ndGgsIC8vINC60L7Qu9C40YfQtdGB0YLQstC+INGC0L7QstCw0YDQvtCyINCy0YHQtdCz0L5cclxuXHRcdFx0YW1vdW50QnV0dG9uID0gTWF0aC5jZWlsKGFtb3VudEl0ZW0gLyBpdGVtSW5QYWdlKSwgLy8g0LrQvtC70LjRh9C10YHRgtCy0L4g0YHRgtGA0LDQvdC40YZcclxuXHRcdFx0cGFnaW5nQnV0dG9ucyA9ICcnIC8vINGA0LDQt9C80LXRgtC60LAg0LrQvdC+0L/QvtC6INC/0LDQs9C40L3QsNGG0LjQuFxyXG5cclxuXHRcdGlmIChhbW91bnRCdXR0b24gPiA2KSB7XHJcblx0XHRcdGlmIChhY3RpdmVQYWdlIDwgMiB8fCBhY3RpdmVQYWdlID4gYW1vdW50QnV0dG9uIC0gMykge1xyXG5cdFx0XHRcdHBhZ2luZ0J1dHRvbnMgKz0gcmV0dXJuQW55UGFnaW5nQnV0dG9ucygwLCAzKVxyXG5cdFx0XHRcdHBhZ2luZ0J1dHRvbnMgKz0gcmV0dXJuUGFnaW5nRG90cygpXHJcblx0XHRcdFx0cGFnaW5nQnV0dG9ucyArPSByZXR1cm5BbnlQYWdpbmdCdXR0b25zKGFtb3VudEJ1dHRvbiAtIDMsIGFtb3VudEJ1dHRvbilcclxuXHRcdFx0fSBlbHNlIGlmIChhY3RpdmVQYWdlID09IDIpIHtcclxuXHRcdFx0XHRwYWdpbmdCdXR0b25zICs9IHJldHVybkFueVBhZ2luZ0J1dHRvbnMoMCwgNClcclxuXHRcdFx0XHRwYWdpbmdCdXR0b25zICs9IHJldHVyblBhZ2luZ0RvdHMoKVxyXG5cdFx0XHRcdHBhZ2luZ0J1dHRvbnMgKz0gcmV0dXJuQW55UGFnaW5nQnV0dG9ucyhhbW91bnRCdXR0b24gLSAxLCBhbW91bnRCdXR0b24pXHJcblx0XHRcdH0gZWxzZSBpZiAoYWN0aXZlUGFnZSA9PSBhbW91bnRCdXR0b24gLSAzKSB7XHJcblx0XHRcdFx0cGFnaW5nQnV0dG9ucyArPSByZXR1cm5BbnlQYWdpbmdCdXR0b25zKDAsIDEpXHJcblx0XHRcdFx0cGFnaW5nQnV0dG9ucyArPSByZXR1cm5QYWdpbmdEb3RzKClcclxuXHRcdFx0XHRwYWdpbmdCdXR0b25zICs9IHJldHVybkFueVBhZ2luZ0J1dHRvbnMoYW1vdW50QnV0dG9uIC0gNCwgYW1vdW50QnV0dG9uKVxyXG5cdFx0XHR9IGVsc2UgaWYgKGFjdGl2ZVBhZ2UgPiAyICYmIGFjdGl2ZVBhZ2UgPCBhbW91bnRCdXR0b24gLSAzKSB7XHJcblx0XHRcdFx0cGFnaW5nQnV0dG9ucyArPSByZXR1cm5BbnlQYWdpbmdCdXR0b25zKDAsIDEpXHJcblx0XHRcdFx0cGFnaW5nQnV0dG9ucyArPSByZXR1cm5QYWdpbmdEb3RzKClcclxuXHRcdFx0XHRwYWdpbmdCdXR0b25zICs9IHJldHVybkFueVBhZ2luZ0J1dHRvbnMoYWN0aXZlUGFnZSAtIDEsIGFjdGl2ZVBhZ2UgKyAyKVxyXG5cdFx0XHRcdHBhZ2luZ0J1dHRvbnMgKz0gcmV0dXJuUGFnaW5nRG90cygpXHJcblx0XHRcdFx0cGFnaW5nQnV0dG9ucyArPSByZXR1cm5BbnlQYWdpbmdCdXR0b25zKGFtb3VudEJ1dHRvbiAtIDEsIGFtb3VudEJ1dHRvbilcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cGFnaW5nQnV0dG9ucyArPSByZXR1cm5BbnlQYWdpbmdCdXR0b25zKDAsIGFtb3VudEJ1dHRvbilcclxuXHRcdH1cclxuXHRcdHJldHVybiBwYWdpbmdCdXR0b25zXHJcblx0fVxyXG5cclxuXHRjb25zdCByZXR1cm5JdGVtSW5BY3RpdmVQYWdlID0gZGF0YSA9PiB7XHJcblx0XHRjb25zdCBmaXJzdEl0ZW0gPSBhY3RpdmVQYWdlICogaXRlbUluUGFnZSxcclxuXHRcdFx0bGFzdEl0ZW0gPSBmaXJzdEl0ZW0gKyBpdGVtSW5QYWdlXHJcblx0XHRyZXR1cm4gZGF0YS5zbGljZShmaXJzdEl0ZW0sIGxhc3RJdGVtKVxyXG5cdH1cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdHNldEFjdGl2ZVBhZ2U6IGkgPT4ge1xyXG5cdFx0XHRhY3RpdmVQYWdlID0gaVxyXG5cdFx0XHRsb2FkR29vZFRvUGFnZSgpXHJcblx0XHR9LFxyXG5cdFx0YWRkUGFnaW5nOiBkYXRhID0+IHtcclxuXHRcdFx0YWRkVG9Db250YWluZXIoJy5qcy1wYWdpbmF0aW9uJywgcmV0dXJuUGFnaW5nQnV0dG9ucyhkYXRhKSlcclxuXHRcdFx0cmV0dXJuIHJldHVybkl0ZW1JbkFjdGl2ZVBhZ2UoZGF0YSlcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbi8v0LrQvtGA0LfQuNC90LBcclxuZnVuY3Rpb24gYmFza2V0U2V0dGluZygpIHtcclxuXHR2YXIgZ29vZEluQmFza2V0ID0gW11cclxuXHJcblx0Y29uc3QgcmV0dXJuQmFza2V0R29vZEl0ZW0gPSBkYXRhID0+IHtcclxuXHRcdGxldCB7IGlkLCBpbWFnZSwgdGl0bGUsIGNvdW50IH0gPSBkYXRhXHJcblx0XHRyZXR1cm4gYDxkaXYgY2xhc3M9XCJiYXNrZXRfX2dvb2QtaXRlbVwiIGJhc2tldC1nb29kLWlkPVwiJHtpZH1cIj5cclxuXHRcdFx0PGJ1dHRvbiBjbGFzcz1cImJhc2tldF9fZ29vZC1yZW1vdmUganMtcmVtb3ZlLWdvb2RcIj4mIzEyODkzODs8L2J1dHRvbj5cclxuXHRcdFx0PGRpdiBjbGFzcz1cImJhc2tldF9fZ29vZC1pbWFnZVwiPjxpbWcgc3JjPVwiJHtpbWFnZX1cIiAvPjwvZGl2PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzPVwiYmFza2V0X19nb29kLW5hbWVcIj4ke3RpdGxlfTwvZGl2PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzPVwiYmFza2V0X19nb29kLWFtb3V0XCI+JHtjb3VudH08L2Rpdj5cclxuXHRcdDwvZGl2PmBcclxuXHR9XHJcblxyXG5cdGNvbnN0IGFkZEdvb2RUb0NvbnRhaW5lciA9ICgpID0+IHtcclxuXHRcdGxldCBnb29kQXJyYXkgPSBnb29kSW5CYXNrZXQubWFwKGVsZW1lbnQgPT4gcmV0dXJuQmFza2V0R29vZEl0ZW0oZWxlbWVudCkpXHJcblx0XHRnb29kQXJyYXkgPSBnb29kQXJyYXkuam9pbignJylcclxuXHRcdGFkZFRvQ29udGFpbmVyKCcuanMtYmFza2V0LWdvb2QnLCBnb29kQXJyYXkpXHJcblx0fVxyXG5cclxuXHRjb25zdCBmaW5kR29vZEFuZFJlbW92ZSA9IChpZCwgaSA9IDApID0+IHtcclxuXHRcdHJldHVybiBpIDwgZ29vZEluQmFza2V0Lmxlbmd0aCB8fCBpZCAhPT0gZ29vZEluQmFza2V0W2ldLmlkID8gZ29vZEluQmFza2V0LnNwbGljZShpLCAxKSA6IGZpbmRHb29kQW5kUmVtb3ZlKGkrKylcclxuXHR9XHJcblxyXG5cdGNvbnN0IGNvdW50VG90YWwgPSAoKSA9PiB7XHJcblx0XHRsZXQgdG90YWxDb3N0ID0gZ29vZEluQmFza2V0LnJlZHVjZShmdW5jdGlvbihzdW0sIGl0ZW0pIHtcclxuXHRcdFx0cmV0dXJuIHN1bSArIGl0ZW0uY291bnQgKiBpdGVtLnByaWNlXHJcblx0XHR9LCAwKVxyXG5cdFx0YWRkVG9Db250YWluZXIoJy5qcy1jb3VudC1yZXN1bHQnLCB0b3RhbENvc3QpXHJcblx0fVxyXG5cclxuXHRjb25zdCBzYXZlVG9Mb2NhbFN0b3JhZ2UgPSAoKSA9PiB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuZ29vZEluQmFza2V0ID0gSlNPTi5zdHJpbmdpZnkoZ29vZEluQmFza2V0KVxyXG5cdH1cclxuXHJcblx0Y29uc3QgcmVsb2FkQmFza2V0ID0gKCkgPT4ge1xyXG5cdFx0c2F2ZVRvTG9jYWxTdG9yYWdlKClcclxuXHRcdGFkZEdvb2RUb0NvbnRhaW5lcigpXHJcblx0XHRjb3VudFRvdGFsKClcclxuXHRcdGNvdW50R29vZEluQmFza2V0KClcclxuXHR9XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRnZXRMb2NhbFNvcmFnZTogKCkgPT4ge1xyXG5cdFx0XHRpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2dvb2RJbkJhc2tldCcpICE9IG51bGwpXHJcblx0XHRcdFx0Z29vZEluQmFza2V0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZ29vZEluQmFza2V0JykpXHJcblx0XHRcdHJlbG9hZEJhc2tldCgpXHJcblx0XHR9LFxyXG5cdFx0Y291bnRHb29kSW5CYXNrZXQ6ICgpID0+IHtcclxuXHRcdFx0bGV0IGFtb3VudEl0ZW0gPSBnb29kSW5CYXNrZXQucmVkdWNlKGZ1bmN0aW9uKHN1bSwgaXRlbSkge1xyXG5cdFx0XHRcdHJldHVybiBzdW0gKyBpdGVtLmNvdW50XHJcblx0XHRcdH0sIDApXHJcblx0XHRcdGFkZFRvQW55Q29udGFpbmVycygnLmpzLWdvb2QtaW4tYmFza2V0JywgYNCi0L7QstCw0YDQvtCyINCyINC60L7RgNC30LjQvdC1ICAke2Ftb3VudEl0ZW19YClcclxuXHRcdH0sXHJcblx0XHRhZGRHb29kVG9CYXNrZXQ6IGRhdGEgPT4ge1xyXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGdvb2RJbkJhc2tldC5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGlmIChkYXRhLmlkID09IGdvb2RJbkJhc2tldFtpXS5pZCkge1xyXG5cdFx0XHRcdFx0Z29vZEluQmFza2V0W2ldLmNvdW50KytcclxuXHRcdFx0XHRcdHJlbG9hZEJhc2tldCgpXHJcblx0XHRcdFx0XHRyZXR1cm5cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZGF0YS5jb3VudCA9IDFcclxuXHRcdFx0Z29vZEluQmFza2V0LnB1c2goZGF0YSlcclxuXHRcdFx0cmVsb2FkQmFza2V0KClcclxuXHRcdH0sXHJcblx0XHRyZW1vdmVHb29kRnJvbUJhc2tldDogZGF0YSA9PiB7XHJcblx0XHRcdGZpbmRHb29kQW5kUmVtb3ZlKGRhdGEpXHJcblx0XHRcdHJlbG9hZEJhc2tldCgpXHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiJdfQ==
