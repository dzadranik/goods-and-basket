"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var n=0,o=new Array(t.length);n<t.length;n++)o[n]=t[n];return o}}var _BasketSetting=BasketSetting(),addGoodToBasket=_BasketSetting.addGoodToBasket,getLocalSorage=_BasketSetting.getLocalSorage,removeGoodFromBasket=_BasketSetting.removeGoodFromBasket,getCountGoodsInBasket=_BasketSetting.getCountGoodsInBasket,_Paging=Paging(),addPagingGetItemsInPage=_Paging.addPagingGetItemsInPage,setActivePage=_Paging.setActivePage,_GoodSetting=GoodSetting(),loadGoods=_GoodSetting.loadGoods,setAvaliable=_GoodSetting.setAvaliable,setSorting=_GoodSetting.setSorting,getGoodInformation=_GoodSetting.getGoodInformation,_containerClassSettin=containerClassSetting(),findContainersAndRemoveClass=_containerClassSettin.findContainersAndRemoveClass;function addContentToContainer(t,n){var o=document.querySelector(t);o&&(o.innerHTML=n)}function containerClassSetting(){return{findContainersAndRemoveClass:function(t,n){!function t(n,o){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e<n.length)return n[e].classList.remove(o),t(n,o,e+1)}(document.querySelectorAll(t),n)}}}function GoodSetting(){var t=[],n=!1,o="name";return{loadGoods:function(){fetch("https://dzadranik.github.io/goods-and-basket/src/json/goods.json").then((function(t){return t.json()})).then((function(e){!function(n){t=n,addContentToContainer(".js-good",n.map((function(t){return function(t){var n=t.id,o=t.image,e=t.title,a=t.price,i=t.descr;return'<div class="good__item js-good-item" data-good-id='.concat(n,'>\n\t\t\t\t\t<div class="good__image"><img src="').concat(o,'"/></div>\n\t\t\t\t\t<div class="good__information">\n\t\t\t\t\t\t<div class="good__title">').concat(e,'</div>\n\t\t\t\t\t\t<div class="good__price">').concat(a,' руб</div>\n\t\t\t\t\t\t<div class="good__description">').concat(i,'</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="good__transaction">\n\t\t\t\t\t\t<button class="good__button js-add-to-basket">Добавить в корзину</button>\n\t\t\t\t\t\t<div class="good__basket-feedback js-good-in-basket"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>')}(t)})).join(""))}(addPagingGetItemsInPage(function(t){return n&&(t=function(t){return t.filter((function(t){return t.avaliable}))}(t)),"cost"==o?t=function(t){return t.sort((function(t,n){return t.price-n.price}))}(t):"name"==o&&(t=function(t){return t.sort((function(t,n){var o=t.title.toLowerCase(),e=n.title.toLowerCase();return o<e?-1:o<e?1:void 0}))}(t)),t}(e)))}))},setAvaliable:function(t){n=t,setActivePage(0),loadGoods()},setSorting:function(t){o!=t&&(o=t,loadGoods())},getGoodInformation:function(n){return t.find((function(t){return t.id==n}))}}}function Paging(){var t=0,n=function(n){return'<button \n\t\t\tclass="pagination__button js-pagination-button '.concat(n===t?"active":"",'" \n\t\t\tdata-p-button-number="').concat(n+1,'">\n\t\t\t\t').concat(n+1,"\n\t\t\t</button>")},o=function t(o,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return o<e?t(o+1,e,a+=n(o)):a};return{setActivePage:function(n){t=n,loadGoods()},addPagingGetItemsInPage:function(n){return addContentToContainer(".js-pagination",function(n){var e=Math.ceil(n.length/5),a="";return e>6?t<2||t>e-3?(a+=o(0,3),a+="<span class='pagination__dots'>...</span>",a+=o(e-3,e)):2==t?(a+=o(0,4),a+="<span class='pagination__dots'>...</span>",a+=o(e-1,e)):t==e-3?(a+=o(0,1),a+="<span class='pagination__dots'>...</span>",a+=o(e-4,e)):t>2&&t<e-3&&(a+=getAnyPButtons(0,1),a+=o(),a+=getAnyPButtons(t-1,t+2),a+=o(),a+=getAnyPButtons(e-1,e)):a+=o(0,e),a}(n)),function(n){var o=5*t,e=o+5;return n.slice(o,e)}(n)}}}function BasketSetting(){var t=[],n=function(){addContentToContainer(".js-basket-good",t.map((function(t){return function(t){var n=t.id,o=t.image,e=t.title,a=t.count;return'<div class="basket__good-item" data-b-good-id="'.concat(n,'">\n\t\t\t<button class="basket__good-remove js-remove-good">&#128938;</button>\n\t\t\t<div class="basket__good-image"><img src="').concat(o,'"/></div>\n\t\t\t<div class="basket__good-name">').concat(e,'</div>\n\t\t\t<div class="basket__good-amout">').concat(a,"</div>\n\t\t</div>")}(t)})).join(""))},o=function(){addContentToContainer(".js-count-result",t.reduce((function(t,n){return t+n.count*n.price}),0))},e=function(){localStorage.goodsInBasket=JSON.stringify(t),n(),o()};return{getLocalSorage:function(){null!=localStorage.getItem("goodsInBasket")&&(t=JSON.parse(localStorage.getItem("goodsInBasket"))),n(),o()},getCountGoodsInBasket:function(){addContentToContainer(".js-good-in-basket",t.reduce((function(t,n){return t+n.count}),0))},addGoodToBasket:function(n){!function(n){t.find((function(t){if(n.id===t.id)return t.count++,!0}))||(n.count=1,t=[].concat(_toConsumableArray(t),[n]))}(n),e()},removeGoodFromBasket:function(n){!function(n){var o=t.findIndex((function(t){return t.id===+n}));t.splice(o,1)}(n),e()}}}document.addEventListener("DOMContentLoaded",(function(){var t=function(t,n,o){document.querySelector(t).addEventListener(n,(function(t){return o(t)}))};t(".js-pagination","click",(function(t){var n=t.target;n.classList.contains("js-pagination-button")&&!n.classList.contains("active")&&setActivePage(n.dataset.pButtonNumber-1)})),t(".js-sorting-buttons","click",(function(t){var n=t.target;if(n.classList.contains("js-sorting")&&!n.classList.contains("active")){var o=n.dataset.sorting;findContainersAndRemoveClass(".js-sorting","active"),setSorting(o),n.classList.add("active")}})),t(".js-avaliable","change",(function(t){setAvaliable(t.target.checked)})),t(".js-good","click",(function(t){if(t.target.classList.contains("js-add-to-basket")){var n=t.target.closest(".js-good-item").dataset.goodId;addGoodToBasket(getGoodInformation(n))}})),t(".js-basket-good","click",(function(t){t.target.classList.contains("js-remove-good")&&removeGoodFromBasket(t.target.parentElement.dataset.bGoodId)}))})),loadGoods(),getLocalSorage();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJfdG9Db25zdW1hYmxlQXJyYXkiLCJhcnIiLCJfYXJyYXlXaXRob3V0SG9sZXMiLCJfaXRlcmFibGVUb0FycmF5IiwiX25vbkl0ZXJhYmxlU3ByZWFkIiwiVHlwZUVycm9yIiwiaXRlciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiT2JqZWN0IiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJjYWxsIiwiQXJyYXkiLCJmcm9tIiwiaXNBcnJheSIsImkiLCJhcnIyIiwibGVuZ3RoIiwiX0Jhc2tldFNldHRpbmciLCJCYXNrZXRTZXR0aW5nIiwiYWRkR29vZFRvQmFza2V0IiwiZ2V0TG9jYWxTb3JhZ2UiLCJyZW1vdmVHb29kRnJvbUJhc2tldCIsImdldENvdW50R29vZHNJbkJhc2tldCIsIl9QYWdpbmciLCJQYWdpbmciLCJhZGRQYWdpbmdHZXRJdGVtc0luUGFnZSIsInNldEFjdGl2ZVBhZ2UiLCJfR29vZFNldHRpbmciLCJHb29kU2V0dGluZyIsImxvYWRHb29kcyIsInNldEF2YWxpYWJsZSIsInNldFNvcnRpbmciLCJnZXRHb29kSW5mb3JtYXRpb24iLCJfY29udGFpbmVyQ2xhc3NTZXR0aW4iLCJjb250YWluZXJDbGFzc1NldHRpbmciLCJmaW5kQ29udGFpbmVyc0FuZFJlbW92ZUNsYXNzIiwiYWRkQ29udGVudFRvQ29udGFpbmVyIiwiY29udGFpbmVyQ2xhc3MiLCJlbGVtZW50IiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaW5uZXJIVE1MIiwiY2xhc3NOYW1lIiwicmVtb3ZlQ2xhc3NJbkNvbnRhaW5lciIsImFsbENvbnRhaW5lcnMiLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZ29vZHNJblBhZ2UiLCJhdmFsaWFibGUiLCJzb3J0aW5nVmFsdWUiLCJmZXRjaCIsInRoZW4iLCJyZXNwb25zZSIsImpzb24iLCJnb29kcyIsIm1hcCIsImdvb2QiLCJpZCIsImltYWdlIiwidGl0bGUiLCJwcmljZSIsImRlc2NyIiwiY29uY2F0IiwiZ2V0R29vZENvbnRlbnQiLCJqb2luIiwiYWRkR29vZHNUb0NvbnRhaW5lciIsImZpbHRlciIsImVsZW0iLCJzb3J0aW5nQXZhbGlhYmxlIiwic29ydCIsInByZXYiLCJuZXh0Iiwic29ydGluZ0J5Q29zdCIsIngiLCJ0b0xvd2VyQ2FzZSIsInkiLCJzb3J0aW5nQnlOYW1lIiwic29ydGluZyIsInZhbHVlIiwiZmluZCIsIml0ZW0iLCJudW1iZXJBY3RpdmVQYWdlIiwiZ2V0UEJ1dHRvbkNvbnRlbnQiLCJudW1iZXIiLCJnZXRQQnV0dG9uc051bWJlckNvbnRlbnQiLCJmaXJzdCIsImxhc3QiLCJwQnV0dG9uc0NvbnRlbnQiLCJpdGVtcyIsImFtb3VudEJ1dHRvbnMiLCJNYXRoIiwiY2VpbCIsImdldEFueVBCdXR0b25zIiwiZ2V0UEJ1dHRvbnNDb250ZW50IiwiZmlyc3RJdGVtIiwibGFzdEl0ZW0iLCJzbGljZSIsImdldEl0ZW1zSW5BY3RpdmVQYWdlIiwiZ29vZHNJbkJhc2tldCIsImFkZEdvb2RUb0NvbnRhaW5lciIsImNvdW50IiwiY291bnRUb3RhbENvc3QiLCJyZWR1Y2UiLCJzdW0iLCJyZWxvYWRCYXNrZXQiLCJsb2NhbFN0b3JhZ2UiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0SXRlbSIsInBhcnNlIiwiZmluZEdvb2RBbmRBZGQiLCJpbmRleCIsImZpbmRJbmRleCIsInNwbGljZSIsImZpbmRHb29kQW5kUmVtb3ZlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZXIiLCJldmVudE5hbWUiLCJmbiIsImV2ZW50IiwidGFyZ2V0RWxlbWVudCIsInRhcmdldCIsImNvbnRhaW5zIiwiZGF0YXNldCIsInBCdXR0b25OdW1iZXIiLCJzb3J0aW5nU2V0dGluZyIsImFkZCIsImNoZWNrZWQiLCJnb29kSWQiLCJjbG9zZXN0IiwicGFyZW50RWxlbWVudCIsImJHb29kSWQiXSwibWFwcGlu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QUFRLHNCQUF1QixTQUFTLFNBQUFHLEdBQ3ZDLElBQU1DLEVBQWdCRCxFQUFNRSxPQUM1QixHQUFJRCxFQUFjNUUsVUFBVThFLFNBQVMsZ0JBQWtCRixFQUFjNUUsVUFBVThFLFNBQVMsVUFBVyxDQUNsRyxJQUFNRyxFQUFpQkwsRUFBY0csUUFBUTlDLFFBQzdDOUMsNkJBQTZCLGNBQWUsVUFDNUNKLFdBQVdrRyxHQUNYTCxFQUFjNUUsVUFBVWtGLElBQUksY0FLOUJWLEVBQVEsZ0JBQWlCLFVBQVUsU0FBQUcsR0FDbEM3RixhQUFhNkYsRUFBTUUsT0FBT00sWUFJM0JYLEVBQVEsV0FBWSxTQUFTLFNBQUFHLEdBQzVCLEdBQUlBLEVBQU1FLE9BQU83RSxVQUFVOEUsU0FBUyxvQkFBcUIsQ0FDeEQsSUFBSU0sRUFBU1QsRUFBTUUsT0FBT1EsUUFBUSxpQkFBaUJOLFFBQVFLLE9BQzNEakgsZ0JBQWdCYSxtQkFBbUJvRyxRQUtyQ1osRUFBUSxrQkFBbUIsU0FBUyxTQUFBRyxHQUMvQkEsRUFBTUUsT0FBTzdFLFVBQVU4RSxTQUFTLG1CQUNuQ3pHLHFCQUFxQnNHLEVBQU1FLE9BQU9TLGNBQWNQLFFBQVFRLGVBSzNEMUcsWUFDQVQiLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHsgYWRkR29vZFRvQmFza2V0LCBnZXRMb2NhbFNvcmFnZSwgcmVtb3ZlR29vZEZyb21CYXNrZXQsIGdldENvdW50R29vZHNJbkJhc2tldCB9ID0gQmFza2V0U2V0dGluZygpLFxyXG5cdHsgYWRkUGFnaW5nR2V0SXRlbXNJblBhZ2UsIHNldEFjdGl2ZVBhZ2UgfSA9IFBhZ2luZygpLFxyXG5cdHsgbG9hZEdvb2RzLCBzZXRBdmFsaWFibGUsIHNldFNvcnRpbmcsIGdldEdvb2RJbmZvcm1hdGlvbiB9ID0gR29vZFNldHRpbmcoKSxcclxuXHR7IGZpbmRDb250YWluZXJzQW5kUmVtb3ZlQ2xhc3MgfSA9IGNvbnRhaW5lckNsYXNzU2V0dGluZygpXHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XHJcblx0Y29uc3QgaGFuZGxlciA9IChlbGVtZW50LCBldmVudE5hbWUsIGZuKSA9PiB7XHJcblx0XHRjb25zdCBlbGVtZW50Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KVxyXG5cdFx0ZWxlbWVudENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZXZlbnQgPT4gZm4oZXZlbnQpKVxyXG5cdH1cclxuXHJcblx0Ly/RgdC70YPRiNCw0LvQutCwINC60L3QvtC/0L7QuiDQv9Cw0LPQuNC90LDRgtC+0YDQsFxyXG5cdGhhbmRsZXIoJy5qcy1wYWdpbmF0aW9uJywgJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0Y29uc3QgdGFyZ2V0RWxlbWVudCA9IGV2ZW50LnRhcmdldFxyXG5cdFx0aWYgKHRhcmdldEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1wYWdpbmF0aW9uLWJ1dHRvbicpICYmICF0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcclxuXHRcdFx0c2V0QWN0aXZlUGFnZSh0YXJnZXRFbGVtZW50LmRhdGFzZXQucEJ1dHRvbk51bWJlciAtIDEpXHJcblx0XHR9XHJcblx0fSlcclxuXHJcblx0Ly8g0YHQu9GD0YjQsNC70LrQsCDRgdC+0YDRgtC40YDQvtCy0L7QulxyXG5cdGhhbmRsZXIoJy5qcy1zb3J0aW5nLWJ1dHRvbnMnLCAnY2xpY2snLCBldmVudCA9PiB7XHJcblx0XHRjb25zdCB0YXJnZXRFbGVtZW50ID0gZXZlbnQudGFyZ2V0XHJcblx0XHRpZiAodGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLXNvcnRpbmcnKSAmJiAhdGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7XHJcblx0XHRcdGNvbnN0IHNvcnRpbmdTZXR0aW5nID0gdGFyZ2V0RWxlbWVudC5kYXRhc2V0LnNvcnRpbmdcclxuXHRcdFx0ZmluZENvbnRhaW5lcnNBbmRSZW1vdmVDbGFzcygnLmpzLXNvcnRpbmcnLCAnYWN0aXZlJylcclxuXHRcdFx0c2V0U29ydGluZyhzb3J0aW5nU2V0dGluZylcclxuXHRcdFx0dGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxyXG5cdFx0fVxyXG5cdH0pXHJcblxyXG5cdC8vINGB0LvRg9GI0LDQu9C60LAg0YHQvtGA0YLQuNGA0L7QstC60Lgg0L/QviDQvdCw0LvQuNGH0LjRjlxyXG5cdGhhbmRsZXIoJy5qcy1hdmFsaWFibGUnLCAnY2hhbmdlJywgZXZlbnQgPT4ge1xyXG5cdFx0c2V0QXZhbGlhYmxlKGV2ZW50LnRhcmdldC5jaGVja2VkKVxyXG5cdH0pXHJcblxyXG5cdC8vINC60L3QvtC/0LrQsCDQtNC+0LHQsNCy0LjRgtGMINCyINC60L7RgNC30LjQvdGDXHJcblx0aGFuZGxlcignLmpzLWdvb2QnLCAnY2xpY2snLCBldmVudCA9PiB7XHJcblx0XHRpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnanMtYWRkLXRvLWJhc2tldCcpKSB7XHJcblx0XHRcdGxldCBnb29kSWQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLmpzLWdvb2QtaXRlbScpLmRhdGFzZXQuZ29vZElkXHJcblx0XHRcdGFkZEdvb2RUb0Jhc2tldChnZXRHb29kSW5mb3JtYXRpb24oZ29vZElkKSlcclxuXHRcdH1cclxuXHR9KVxyXG5cclxuXHQvLyDQutC90L7Qv9C60LAg0YPQtNCw0LvQuNGC0Ywg0LjQtyDQutC+0YDQt9C40L3Ri1xyXG5cdGhhbmRsZXIoJy5qcy1iYXNrZXQtZ29vZCcsICdjbGljaycsIGV2ZW50ID0+IHtcclxuXHRcdGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1yZW1vdmUtZ29vZCcpKSB7XHJcblx0XHRcdHJlbW92ZUdvb2RGcm9tQmFza2V0KGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50LmRhdGFzZXQuYkdvb2RJZClcclxuXHRcdH1cclxuXHR9KVxyXG59KVxyXG5cclxubG9hZEdvb2RzKClcclxuZ2V0TG9jYWxTb3JhZ2UoKVxyXG5cclxuLy/QlNC+0LHQsNCy0LvQtdC90LjQtSDRjdC70LXQvNC10L3RgtC+0LIg0LIg0LrQvtC90YLQtdC50L3QtdGAXHJcbmZ1bmN0aW9uIGFkZENvbnRlbnRUb0NvbnRhaW5lcihjb250YWluZXJDbGFzcywgZWxlbWVudCkge1xyXG5cdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyQ2xhc3MpXHJcblx0aWYgKGNvbnRhaW5lcikgY29udGFpbmVyLmlubmVySFRNTCA9IGVsZW1lbnRcclxufVxyXG5cclxuLy/Rg9C00LDQu9C40YLRjCDQutC70LDRgdGBINGDINCz0YDRg9C/0L/RiyDQutC+0L3RgtC10LnQvdC10YDQvtCyXHJcbmZ1bmN0aW9uIGNvbnRhaW5lckNsYXNzU2V0dGluZygpIHtcclxuXHRjb25zdCByZW1vdmVDbGFzc0luQ29udGFpbmVyID0gKGFsbENvbnRhaW5lcnMsIGNsYXNzTmFtZSwgaSA9IDApID0+IHtcclxuXHRcdGlmIChpIDwgYWxsQ29udGFpbmVycy5sZW5ndGgpIHtcclxuXHRcdFx0YWxsQ29udGFpbmVyc1tpXS5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSlcclxuXHRcdFx0cmV0dXJuIHJlbW92ZUNsYXNzSW5Db250YWluZXIoYWxsQ29udGFpbmVycywgY2xhc3NOYW1lLCBpICsgMSlcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIHtcclxuXHRcdGZpbmRDb250YWluZXJzQW5kUmVtb3ZlQ2xhc3M6IChjb250YWluZXJDbGFzcywgY2xhc3NOYW1lKSA9PiB7XHJcblx0XHRcdGxldCBhbGxDb250YWluZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb250YWluZXJDbGFzcylcclxuXHRcdFx0cmVtb3ZlQ2xhc3NJbkNvbnRhaW5lcihhbGxDb250YWluZXJzLCBjbGFzc05hbWUpXHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG4vLyDRgtC+0LLQsNGA0YtcclxuZnVuY3Rpb24gR29vZFNldHRpbmcoKSB7XHJcblx0dmFyIGdvb2RzSW5QYWdlID0gW10sXHJcblx0XHRhdmFsaWFibGUgPSBmYWxzZSxcclxuXHRcdHNvcnRpbmdWYWx1ZSA9ICduYW1lJ1xyXG5cclxuXHRjb25zdCBzb3J0aW5nQXZhbGlhYmxlID0gZ29vZHMgPT4ge1xyXG5cdFx0cmV0dXJuIGdvb2RzLmZpbHRlcihlbGVtID0+IGVsZW0uYXZhbGlhYmxlKVxyXG5cdH1cclxuXHJcblx0Y29uc3Qgc29ydGluZ0J5Q29zdCA9IGdvb2RzID0+IHtcclxuXHRcdHJldHVybiBnb29kcy5zb3J0KChwcmV2LCBuZXh0KSA9PiBwcmV2LnByaWNlIC0gbmV4dC5wcmljZSlcclxuXHR9XHJcblxyXG5cdGNvbnN0IHNvcnRpbmdCeU5hbWUgPSBnb29kcyA9PiB7XHJcblx0XHRyZXR1cm4gZ29vZHMuc29ydCgocHJldiwgbmV4dCkgPT4ge1xyXG5cdFx0XHRjb25zdCB4ID0gcHJldi50aXRsZS50b0xvd2VyQ2FzZSgpXHJcblx0XHRcdGNvbnN0IHkgPSBuZXh0LnRpdGxlLnRvTG93ZXJDYXNlKClcclxuXHRcdFx0aWYgKHggPCB5KSByZXR1cm4gLTFcclxuXHRcdFx0aWYgKHggPCB5KSByZXR1cm4gMVxyXG5cdFx0fSlcclxuXHR9XHJcblxyXG5cdGNvbnN0IHNvcnRpbmcgPSBnb29kcyA9PiB7XHJcblx0XHRpZiAoYXZhbGlhYmxlKSBnb29kcyA9IHNvcnRpbmdBdmFsaWFibGUoZ29vZHMpXHJcblxyXG5cdFx0aWYgKHNvcnRpbmdWYWx1ZSA9PSAnY29zdCcpIGdvb2RzID0gc29ydGluZ0J5Q29zdChnb29kcylcclxuXHRcdGVsc2UgaWYgKHNvcnRpbmdWYWx1ZSA9PSAnbmFtZScpIGdvb2RzID0gc29ydGluZ0J5TmFtZShnb29kcylcclxuXHRcdHJldHVybiBnb29kc1xyXG5cdH1cclxuXHJcblx0Y29uc3QgZ2V0R29vZENvbnRlbnQgPSBnb29kID0+IHtcclxuXHRcdGxldCB7IGlkLCBpbWFnZSwgdGl0bGUsIHByaWNlLCBkZXNjciB9ID0gZ29vZFxyXG5cdFx0cmV0dXJuIGA8ZGl2IGNsYXNzPVwiZ29vZF9faXRlbSBqcy1nb29kLWl0ZW1cIiBkYXRhLWdvb2QtaWQ9JHtpZH0+XHJcblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9faW1hZ2VcIj48aW1nIHNyYz1cIiR7aW1hZ2V9XCIvPjwvZGl2PlxyXG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX2luZm9ybWF0aW9uXCI+XHJcblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJnb29kX190aXRsZVwiPiR7dGl0bGV9PC9kaXY+XHJcblx0XHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJnb29kX19wcmljZVwiPiR7cHJpY2V9INGA0YPQsTwvZGl2PlxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9fZGVzY3JpcHRpb25cIj4ke2Rlc2NyfTwvZGl2PlxyXG5cdFx0XHRcdFx0PC9kaXY+XHJcblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9fdHJhbnNhY3Rpb25cIj5cclxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cImdvb2RfX2J1dHRvbiBqcy1hZGQtdG8tYmFza2V0XCI+0JTQvtCx0LDQstC40YLRjCDQsiDQutC+0YDQt9C40L3RgzwvYnV0dG9uPlxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9fYmFza2V0LWZlZWRiYWNrIGpzLWdvb2QtaW4tYmFza2V0XCI+PC9kaXY+XHJcblx0XHRcdFx0XHQ8L2Rpdj5cclxuXHRcdFx0XHQ8L2Rpdj5gXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBhZGRHb29kc1RvQ29udGFpbmVyKGdvb2RzKSB7XHJcblx0XHRnb29kc0luUGFnZSA9IGdvb2RzXHJcblx0XHRjb25zdCBnb29kc0NvbnRlbnQgPSBnb29kcy5tYXAoZ29vZCA9PiBnZXRHb29kQ29udGVudChnb29kKSkuam9pbignJylcclxuXHRcdGFkZENvbnRlbnRUb0NvbnRhaW5lcignLmpzLWdvb2QnLCBnb29kc0NvbnRlbnQpXHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0bG9hZEdvb2RzOiAoKSA9PiB7XHJcblx0XHRcdGZldGNoKCdodHRwczovL2R6YWRyYW5pay5naXRodWIuaW8vZ29vZHMtYW5kLWJhc2tldC9zcmMvanNvbi9nb29kcy5qc29uJylcclxuXHRcdFx0XHQudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcblx0XHRcdFx0LnRoZW4oZ29vZHMgPT4ge1xyXG5cdFx0XHRcdFx0YWRkR29vZHNUb0NvbnRhaW5lcihhZGRQYWdpbmdHZXRJdGVtc0luUGFnZShzb3J0aW5nKGdvb2RzKSkpXHJcblx0XHRcdFx0fSlcclxuXHRcdH0sXHJcblx0XHRzZXRBdmFsaWFibGU6IHZhbHVlID0+IHtcclxuXHRcdFx0YXZhbGlhYmxlID0gdmFsdWVcclxuXHRcdFx0c2V0QWN0aXZlUGFnZSgwKVxyXG5cdFx0XHRsb2FkR29vZHMoKVxyXG5cdFx0fSxcclxuXHRcdHNldFNvcnRpbmc6IHZhbHVlID0+IHtcclxuXHRcdFx0aWYgKHNvcnRpbmdWYWx1ZSAhPSB2YWx1ZSkge1xyXG5cdFx0XHRcdHNvcnRpbmdWYWx1ZSA9IHZhbHVlXHJcblx0XHRcdFx0bG9hZEdvb2RzKClcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdGdldEdvb2RJbmZvcm1hdGlvbjogaWQgPT4ge1xyXG5cdFx0XHRyZXR1cm4gZ29vZHNJblBhZ2UuZmluZChpdGVtID0+IGl0ZW0uaWQgPT0gaWQpXHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG4vL9C/0LDQs9C40L3QsNGG0LjRj1xyXG5mdW5jdGlvbiBQYWdpbmcoKSB7XHJcblx0Y29uc3QgYW1vdW50UGFnZUl0ZW1zID0gNSAvLyDQutC+0LvQuNGH0LXRgdGC0LLQviDRjdC70LXQvNC10L3RgtC+0LIg0L3QsCDRgdGC0YDQsNC90LjRhtC1XHJcblx0dmFyIG51bWJlckFjdGl2ZVBhZ2UgPSAwIC8vINCw0LrRgtC40LLQvdCw0Y8g0YHRgtGA0LDQvdC40YbQsFxyXG5cclxuXHRjb25zdCBnZXRQQnV0dG9uQ29udGVudCA9IG51bWJlciA9PiB7XHJcblx0XHRyZXR1cm4gYDxidXR0b24gXHJcblx0XHRcdGNsYXNzPVwicGFnaW5hdGlvbl9fYnV0dG9uIGpzLXBhZ2luYXRpb24tYnV0dG9uICR7bnVtYmVyID09PSBudW1iZXJBY3RpdmVQYWdlID8gJ2FjdGl2ZScgOiAnJ31cIiBcclxuXHRcdFx0ZGF0YS1wLWJ1dHRvbi1udW1iZXI9XCIke251bWJlciArIDF9XCI+XHJcblx0XHRcdFx0JHtudW1iZXIgKyAxfVxyXG5cdFx0XHQ8L2J1dHRvbj5gXHJcblx0fVxyXG5cclxuXHRjb25zdCBnZXRQRG90c0NvbnRlbnQgPSAoKSA9PiB7XHJcblx0XHRyZXR1cm4gYDxzcGFuIGNsYXNzPSdwYWdpbmF0aW9uX19kb3RzJz4uLi48L3NwYW4+YFxyXG5cdH1cclxuXHJcblx0Y29uc3QgZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50ID0gKGZpcnN0LCBsYXN0LCBwQnV0dG9uc0NvbnRlbnQgPSAnJykgPT4ge1xyXG5cdFx0aWYgKGZpcnN0IDwgbGFzdCkge1xyXG5cdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UEJ1dHRvbkNvbnRlbnQoZmlyc3QpXHJcblx0XHRcdHJldHVybiBnZXRQQnV0dG9uc051bWJlckNvbnRlbnQoZmlyc3QgKyAxLCBsYXN0LCBwQnV0dG9uc0NvbnRlbnQpXHJcblx0XHR9XHJcblx0XHRyZXR1cm4gcEJ1dHRvbnNDb250ZW50XHJcblx0fVxyXG5cclxuXHRjb25zdCBnZXRQQnV0dG9uc0NvbnRlbnQgPSBpdGVtcyA9PiB7XHJcblx0XHRsZXQgYW1vdW50QnV0dG9ucyA9IE1hdGguY2VpbChpdGVtcy5sZW5ndGggLyBhbW91bnRQYWdlSXRlbXMpLCAvLyDQutC+0LvQuNGH0LXRgdGC0LLQviDRgdGC0YDQsNC90LjRhlxyXG5cdFx0XHRwQnV0dG9uc0NvbnRlbnQgPSAnJyAvLyDRgNCw0LfQvNC10YLQutCwINC60L3QvtC/0L7QuiDQv9Cw0LPQuNC90LDRhtC40LhcclxuXHJcblx0XHRpZiAoYW1vdW50QnV0dG9ucyA+IDYpIHtcclxuXHRcdFx0aWYgKG51bWJlckFjdGl2ZVBhZ2UgPCAyIHx8IG51bWJlckFjdGl2ZVBhZ2UgPiBhbW91bnRCdXR0b25zIC0gMykge1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRQQnV0dG9uc051bWJlckNvbnRlbnQoMCwgMylcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UERvdHNDb250ZW50KClcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KGFtb3VudEJ1dHRvbnMgLSAzLCBhbW91bnRCdXR0b25zKVxyXG5cdFx0XHR9IGVsc2UgaWYgKG51bWJlckFjdGl2ZVBhZ2UgPT0gMikge1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRQQnV0dG9uc051bWJlckNvbnRlbnQoMCwgNClcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UERvdHNDb250ZW50KClcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KGFtb3VudEJ1dHRvbnMgLSAxLCBhbW91bnRCdXR0b25zKVxyXG5cdFx0XHR9IGVsc2UgaWYgKG51bWJlckFjdGl2ZVBhZ2UgPT0gYW1vdW50QnV0dG9ucyAtIDMpIHtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KDAsIDEpXHJcblx0XHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IGdldFBEb3RzQ29udGVudCgpXHJcblx0XHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IGdldFBCdXR0b25zTnVtYmVyQ29udGVudChhbW91bnRCdXR0b25zIC0gNCwgYW1vdW50QnV0dG9ucylcclxuXHRcdFx0fSBlbHNlIGlmIChudW1iZXJBY3RpdmVQYWdlID4gMiAmJiBudW1iZXJBY3RpdmVQYWdlIDwgYW1vdW50QnV0dG9ucyAtIDMpIHtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0QW55UEJ1dHRvbnMoMCwgMSlcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KClcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gZ2V0QW55UEJ1dHRvbnMobnVtYmVyQWN0aXZlUGFnZSAtIDEsIG51bWJlckFjdGl2ZVBhZ2UgKyAyKVxyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRQQnV0dG9uc051bWJlckNvbnRlbnQoKVxyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSBnZXRBbnlQQnV0dG9ucyhhbW91bnRCdXR0b25zIC0gMSwgYW1vdW50QnV0dG9ucylcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IGdldFBCdXR0b25zTnVtYmVyQ29udGVudCgwLCBhbW91bnRCdXR0b25zKVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHBCdXR0b25zQ29udGVudFxyXG5cdH1cclxuXHJcblx0Y29uc3QgZ2V0SXRlbXNJbkFjdGl2ZVBhZ2UgPSBpdGVtcyA9PiB7XHJcblx0XHRjb25zdCBmaXJzdEl0ZW0gPSBudW1iZXJBY3RpdmVQYWdlICogYW1vdW50UGFnZUl0ZW1zLFxyXG5cdFx0XHRsYXN0SXRlbSA9IGZpcnN0SXRlbSArIGFtb3VudFBhZ2VJdGVtc1xyXG5cdFx0cmV0dXJuIGl0ZW1zLnNsaWNlKGZpcnN0SXRlbSwgbGFzdEl0ZW0pXHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0c2V0QWN0aXZlUGFnZTogbnVtYmVyID0+IHtcclxuXHRcdFx0bnVtYmVyQWN0aXZlUGFnZSA9IG51bWJlclxyXG5cdFx0XHRsb2FkR29vZHMoKVxyXG5cdFx0fSxcclxuXHRcdGFkZFBhZ2luZ0dldEl0ZW1zSW5QYWdlOiBpdGVtcyA9PiB7XHJcblx0XHRcdGFkZENvbnRlbnRUb0NvbnRhaW5lcignLmpzLXBhZ2luYXRpb24nLCBnZXRQQnV0dG9uc0NvbnRlbnQoaXRlbXMpKVxyXG5cdFx0XHRyZXR1cm4gZ2V0SXRlbXNJbkFjdGl2ZVBhZ2UoaXRlbXMpXHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG4vL9C60L7RgNC30LjQvdCwXHJcbmZ1bmN0aW9uIEJhc2tldFNldHRpbmcoKSB7XHJcblx0dmFyIGdvb2RzSW5CYXNrZXQgPSBbXVxyXG5cclxuXHRjb25zdCBnZXRHb29kQ29udGVudCA9IGdvb2QgPT4ge1xyXG5cdFx0bGV0IHsgaWQsIGltYWdlLCB0aXRsZSwgY291bnQgfSA9IGdvb2RcclxuXHRcdHJldHVybiBgPGRpdiBjbGFzcz1cImJhc2tldF9fZ29vZC1pdGVtXCIgZGF0YS1iLWdvb2QtaWQ9XCIke2lkfVwiPlxyXG5cdFx0XHQ8YnV0dG9uIGNsYXNzPVwiYmFza2V0X19nb29kLXJlbW92ZSBqcy1yZW1vdmUtZ29vZFwiPiYjMTI4OTM4OzwvYnV0dG9uPlxyXG5cdFx0XHQ8ZGl2IGNsYXNzPVwiYmFza2V0X19nb29kLWltYWdlXCI+PGltZyBzcmM9XCIke2ltYWdlfVwiLz48L2Rpdj5cclxuXHRcdFx0PGRpdiBjbGFzcz1cImJhc2tldF9fZ29vZC1uYW1lXCI+JHt0aXRsZX08L2Rpdj5cclxuXHRcdFx0PGRpdiBjbGFzcz1cImJhc2tldF9fZ29vZC1hbW91dFwiPiR7Y291bnR9PC9kaXY+XHJcblx0XHQ8L2Rpdj5gXHJcblx0fVxyXG5cclxuXHRjb25zdCBhZGRHb29kVG9Db250YWluZXIgPSAoKSA9PiB7XHJcblx0XHRsZXQgZ29vZHNDb250ZW50ID0gZ29vZHNJbkJhc2tldC5tYXAoZ29vZCA9PiBnZXRHb29kQ29udGVudChnb29kKSkuam9pbignJylcclxuXHRcdGFkZENvbnRlbnRUb0NvbnRhaW5lcignLmpzLWJhc2tldC1nb29kJywgZ29vZHNDb250ZW50KVxyXG5cdH1cclxuXHJcblx0Y29uc3QgZmluZEdvb2RBbmRSZW1vdmUgPSBpZCA9PiB7XHJcblx0XHRsZXQgaW5kZXggPSBnb29kc0luQmFza2V0LmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09ICtpZClcclxuXHRcdGdvb2RzSW5CYXNrZXQuc3BsaWNlKGluZGV4LCAxKVxyXG5cdH1cclxuXHRjb25zdCBmaW5kR29vZEFuZEFkZCA9IGdvb2QgPT4ge1xyXG5cdFx0aWYgKFxyXG5cdFx0XHQhZ29vZHNJbkJhc2tldC5maW5kKGl0ZW0gPT4ge1xyXG5cdFx0XHRcdGlmIChnb29kLmlkID09PSBpdGVtLmlkKSB7XHJcblx0XHRcdFx0XHRpdGVtLmNvdW50KytcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KVxyXG5cdFx0KSB7XHJcblx0XHRcdGdvb2QuY291bnQgPSAxXHJcblx0XHRcdGdvb2RzSW5CYXNrZXQgPSBbLi4uZ29vZHNJbkJhc2tldCwgZ29vZF1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGNvbnN0IGNvdW50VG90YWxDb3N0ID0gKCkgPT4ge1xyXG5cdFx0bGV0IHRvdGFsQ29zdCA9IGdvb2RzSW5CYXNrZXQucmVkdWNlKGZ1bmN0aW9uKHN1bSwgaXRlbSkge1xyXG5cdFx0XHRyZXR1cm4gc3VtICsgaXRlbS5jb3VudCAqIGl0ZW0ucHJpY2VcclxuXHRcdH0sIDApXHJcblx0XHRhZGRDb250ZW50VG9Db250YWluZXIoJy5qcy1jb3VudC1yZXN1bHQnLCB0b3RhbENvc3QpXHJcblx0fVxyXG5cclxuXHRjb25zdCBzYXZlVG9Mb2NhbFN0b3JhZ2UgPSAoKSA9PiB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuZ29vZHNJbkJhc2tldCA9IEpTT04uc3RyaW5naWZ5KGdvb2RzSW5CYXNrZXQpXHJcblx0fVxyXG5cclxuXHRjb25zdCBjb3VudEdvb2RzSW5CYXNrZXQgPSAoKSA9PiB7XHJcblx0XHRyZXR1cm4gZ29vZHNJbkJhc2tldC5yZWR1Y2UoZnVuY3Rpb24oc3VtLCBpdGVtKSB7XHJcblx0XHRcdHJldHVybiBzdW0gKyBpdGVtLmNvdW50XHJcblx0XHR9LCAwKVxyXG5cdH1cclxuXHJcblx0Y29uc3QgcmVsb2FkQmFza2V0ID0gKCkgPT4ge1xyXG5cdFx0c2F2ZVRvTG9jYWxTdG9yYWdlKClcclxuXHRcdGFkZEdvb2RUb0NvbnRhaW5lcigpXHJcblx0XHRjb3VudFRvdGFsQ29zdCgpXHJcblx0fVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0Z2V0TG9jYWxTb3JhZ2U6ICgpID0+IHtcclxuXHRcdFx0aWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdnb29kc0luQmFza2V0JykgIT0gbnVsbClcclxuXHRcdFx0XHRnb29kc0luQmFza2V0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZ29vZHNJbkJhc2tldCcpKVxyXG5cdFx0XHRhZGRHb29kVG9Db250YWluZXIoKVxyXG5cdFx0XHRjb3VudFRvdGFsQ29zdCgpXHJcblx0XHR9LFxyXG5cdFx0Z2V0Q291bnRHb29kc0luQmFza2V0OiAoKSA9PiB7XHJcblx0XHRcdGFkZENvbnRlbnRUb0NvbnRhaW5lcignLmpzLWdvb2QtaW4tYmFza2V0JywgY291bnRHb29kc0luQmFza2V0KCkpXHJcblx0XHR9LFxyXG5cdFx0YWRkR29vZFRvQmFza2V0OiBnb29kID0+IHtcclxuXHRcdFx0ZmluZEdvb2RBbmRBZGQoZ29vZClcclxuXHRcdFx0cmVsb2FkQmFza2V0KClcclxuXHRcdH0sXHJcblx0XHRyZW1vdmVHb29kRnJvbUJhc2tldDogaWQgPT4ge1xyXG5cdFx0XHRmaW5kR29vZEFuZFJlbW92ZShpZClcclxuXHRcdFx0cmVsb2FkQmFza2V0KClcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIl19
