"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var Goods=function(){function t(){_classCallCheck(this,t),this._goodsInPage=[],this._avaliable=!1,this._sortingValue="name"}return _createClass(t,[{key:"_sortingAvaliable",value:function(t){return t.filter((function(t){return t.avaliable}))}},{key:"_sortingByCost",value:function(t){return t.sort((function(t,e){return t.price-e.price}))}},{key:"_sortingByName",value:function(t){return t.sort((function(t,e){var n=t.title.toLowerCase(),o=e.title.toLowerCase();return n<o?-1:n<o?1:void 0}))}},{key:"_sorting",value:function(t){return this._avaliable&&(t=this._sortingAvaliable(t)),"cost"==this._sortingValue?t=this._sortingByCost(t):"name"==this._sortingValue&&(t=this._sortingByName(t)),t}},{key:"_truncate",value:function(t,e){if(t.length>e){var n=t.lastIndexOf(" ",e);return"".concat(t.slice(0,n)," ...")}return t}},{key:"_getGoodContent",value:function(t){var e=t.id,n=t.image,o=t.title,a=t.price,s=t.descr;return'<div class="good__item js-good-item" data-good-id='.concat(e,'>\n\t\t\t\t\t<div class="good__image"><img src="').concat(n,'"/></div>\n\t\t\t\t\t<div class="good__information">\n\t\t\t\t\t\t<div class="good__title">').concat(o,'</div>\n\t\t\t\t\t\t<div class="good__price">').concat(a,' руб</div>\n\t\t\t\t\t\t<div class="good__description">').concat(this._truncate(s,65),'</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="good__transaction">\n\t\t\t\t\t\t<button class="good__button js-add-to-basket">Добавить в корзину</button>\n\t\t\t\t\t\t<div class="good__basket-feedback js-good-in-basket"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>')}},{key:"_addGoodsToContainer",value:function(t){var e=this;this._goodsInPage=t,addContentToContainer(t.map((function(t){return e._getGoodContent(t)})).join(""),".js-good")}},{key:"loadGoods",value:function(){var t=this;fetch("https://dzadranik.github.io/goods-and-basket/src/json/goods.json").then((function(t){return t.json()})).then((function(e){t._addGoodsToContainer(goodsPaging.addPagingGetItemsInPage(t._sorting(e)))}))}},{key:"setAvaliable",value:function(t){this._avaliable=t,this.loadGoods()}},{key:"setSorting",value:function(t){this._sortingValue!=t&&(this._sortingValue=t,this.loadGoods())}},{key:"getGoodInformation",value:function(t){return this._goodsInPage.find((function(e){return e.id==t}))}}]),t}(),Basket=function(){function t(){_classCallCheck(this,t),this._goodsInBasket=null!=localStorage.getItem("goodsInBasket")?JSON.parse(localStorage.getItem("goodsInBasket")):[]}return _createClass(t,[{key:"_getGoodContent",value:function(t){var e=t.id,n=t.image,o=t.title,a=t.count;return'<div class="basket__good-item" data-b-good-id="'.concat(e,'">\n\t\t\t<button class="basket__good-remove js-remove-good">&#128938;</button>\n\t\t\t<div class="basket__good-image"><img src="').concat(n,'"/></div>\n\t\t\t<div class="basket__good-name">').concat(o,'</div>\n\t\t\t<div class="basket__good-amout">').concat(a,"</div>\n\t\t</div>")}},{key:"_addGoodsToContainer",value:function(){var t=this;addContentToContainer(this._goodsInBasket.map((function(e){return t._getGoodContent(e)})).join(""),".js-basket-good")}},{key:"_findGoodAndRemove",value:function(t){var e=this._goodsInBasket.findIndex((function(e){return e.id===+t}));return this._goodsInBasket.splice(e,1)}},{key:"_findGoodAndAdd",value:function(t){var e=this._goodsInBasket.find((function(e){return e.id===t.id}));e?e.count++:(t.count=1,this._goodsInBasket=[].concat(_toConsumableArray(this._goodsInBasket),[t]))}},{key:"_addTotalCost",value:function(){addContentToContainer(this._goodsInBasket.reduce((function(t,e){return t+e.count*e.price}),0),".js-count-result")}},{key:"_saveToLocalStorage",value:function(){localStorage.goodsInBasket=JSON.stringify(this._goodsInBasket)}},{key:"_countGoodsInBasket",value:function(){return this._goodsInBasket.reduce((function(t,e){return t+e.count}),0)}},{key:"addCountGoodsInBasket",value:function(){addContentToContainer(this._countGoodsInBasket(),".js-good-in-basket")}},{key:"addGoodToBasket",value:function(t){this._findGoodAndAdd(t),this._saveToLocalStorage(),this.reloadBasket()}},{key:"removeGoodFromBasket",value:function(t){this._findGoodAndRemove(t),this._saveToLocalStorage(),this.reloadBasket()}},{key:"reloadBasket",value:function(){this._addGoodsToContainer(),this._addTotalCost()}}]),t}(),Paging=function(){function t(e,n){_classCallCheck(this,t),this._container=n,this._amountPageItems=e,this._activePage=0}return _createClass(t,[{key:"_getPButtonContent",value:function(t){return'<button \n\t\t\t\t\tclass="pagination__button js-pagination-button \n\t\t\t\t\t'.concat(t===this._activePage?"active":"",'" \n\t\t\t\t\tdata-p-button-number="').concat(t+1,'">\n\t\t\t\t\t\t').concat(t+1,"\n\t\t\t\t</button>")}},{key:"_getPDotsContent",value:function(){return"<span class='pagination__dots'>...</span>"}},{key:"_getPButtonsNumberContent",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t<e?(n+=this._getPButtonContent(t),this._getPButtonsNumberContent(t+1,e,n)):n}},{key:"_getPButtonsContent",value:function(t){var e=Math.ceil(t.length/this._amountPageItems),n="";return e>6?this._activePage<2||this._activePage>e-3?(n+=this._getPButtonsNumberContent(0,3),n+=this._getPDotsContent(),n+=this._getPButtonsNumberContent(e-3,e)):2==this._activePage?(n+=this._getPButtonsNumberContent(0,4),n+=this._getPDotsContent(),n+=this._getPButtonsNumberContent(e-1,e)):this._activePage==e-3?(n+=this._getPButtonsNumberContent(0,1),n+=this._getPDotsContent(),n+=this._getPButtonsNumberContent(e-4,e)):this._activePage>2&&this._activePage<e-3&&(n+=this._getPButtonsNumberContent(0,1),n+=this._getPDotsContent(),n+=this._getPButtonsNumberContent(this._activePage-1,this._activePage+2),n+=this._getPDotsContent(),n+=this._getPButtonsNumberContent(e-1,e)):n+=this._getPButtonsNumberContent(0,e),n}},{key:"_getItemsInActivePage",value:function(t){var e=this._activePage*this._amountPageItems,n=e+this._amountPageItems;return t.slice(e,n)}},{key:"setActivePage",value:function(t){this._activePage=t}},{key:"addPagingGetItemsInPage",value:function(t){return addContentToContainer(this._getPButtonsContent(t),this._container),this._getItemsInActivePage(t)}}]),t}();function addContentToContainer(t,e){var n=document.querySelector(e);n&&(n.innerHTML=t)}function findContainersAndRemoveClass(t,e){var n=document.querySelectorAll(t);!function t(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(o<n.length)return n[o].classList.remove(e),t(o+1)}()}document.addEventListener("DOMContentLoaded",(function(){var t=function(t,e,n){document.querySelector(t).addEventListener(e,(function(t){return n(t)}))};t(".js-pagination","click",(function(t){var e=t.target;e.classList.contains("js-pagination-button")&&!e.classList.contains("active")&&(goodsPaging.setActivePage(e.dataset.pButtonNumber-1),goods.loadGoods())})),t(".js-sorting-buttons","click",(function(t){var e=t.target;if(e.classList.contains("js-sorting")&&!e.classList.contains("active")){var n=e.dataset.sorting;findContainersAndRemoveClass(".js-sorting","active"),goods.setSorting(n),e.classList.add("active")}})),t(".js-avaliable","change",(function(t){goodsPaging.setActivePage(0),goods.setAvaliable(t.target.checked)})),t(".js-good","click",(function(t){if(t.target.classList.contains("js-add-to-basket")){var e=t.target.closest(".js-good-item").dataset.goodId;basket.addGoodToBasket(goods.getGoodInformation(e))}})),t(".js-basket-good","click",(function(t){t.target.classList.contains("js-remove-good")&&basket.removeGoodFromBasket(t.target.parentElement.dataset.bGoodId)}))}));var basket=new Basket,goods=new Goods,goodsPaging=new Paging(5,".js-pagination");goods.loadGoods(),basket.reloadBasket();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJfdG9Db25zdW1hYmxlQXJyYXkiLCJhcnIiLCJfYXJyYXlXaXRob3V0SG9sZXMiLCJfaXRlcmFibGVUb0FycmF5IiwiX25vbkl0ZXJhYmxlU3ByZWFkIiwiVHlwZUVycm9yIiwiaXRlciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiT2JqZWN0IiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJjYWxsIiwiQXJyYXkiLCJmcm9tIiwiaXNBcnJheSIsImkiLCJhcnIyIiwibGVuZ3RoIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIl9kZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJfY3JlYXRlQ2xhc3MiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJHb29kcyIsInRoaXMiLCJfZ29vZHNJblBhZ2UiLCJfYXZhbGlhYmxlIiwiX3NvcnRpbmdWYWx1ZSIsInZhbHVlIiwiZ29vZHMiLCJmaWx0ZXIiLCJlbGVtIiwiYXZhbGlhYmxlIiwic29ydCIsInByZXYiLCJuZXh0IiwicHJpY2UiLCJ4IiwidGl0bGUiLCJ0b0xvd2VyQ2FzZSIsInkiLCJfc29ydGluZ0F2YWxpYWJsZSIsIl9zb3J0aW5nQnlDb3N0IiwiX3NvcnRpbmdCeU5hbWUiLCJkZXNjciIsIm1heExlbmd0aCIsImdhcCIsImxhc3RJbmRleE9mIiwiY29uY2F0Iiwic2xpY2UiLCJnb29kIiwiaWQiLCJpbWFnZSIsIl90cnVuY2F0ZSIsIl90aGlzIiwiYWRkQ29udGVudFRvQ29udGFpbmVyIiwibWFwIiwiX2dldEdvb2RDb250ZW50Iiwiam9pbiIsIl90aGlzMiIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsIl9hZGRHb29kc1RvQ29udGFpbmVyIiwiZ29vZHNQYWdpbmciLCJhZGRQYWdpbmdHZXRJdGVtc0luUGFnZSIsIl9zb3J0aW5nIiwibG9hZEdvb2RzIiwiZmluZCIsIml0ZW0iLCJCYXNrZXQiLCJfZ29vZHNJbkJhc2tldCIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJKU09OIiwicGFyc2UiLCJjb3VudCIsIl90aGlzMyIsImdvb2RJbmRleCIsImZpbmRJbmRleCIsInNwbGljZSIsImdvb2RJbkJhc2tldCIsInJlZHVjZSIsInN1bSIsImdvb2RzSW5CYXNrZXQiLCJzdHJpbmdpZnkiLCJfY291bnRHb29kc0luQmFza2V0IiwiX2ZpbmRHb29kQW5kQWRkIiwiX3NhdmVUb0xvY2FsU3RvcmFnZSIsInJlbG9hZEJhc2tldCIsIl9maW5kR29vZEFuZFJlbW92ZSIsIl9hZGRUb3RhbENvc3QiLCJQYWdpbmciLCJhbW91bnRQYWdlSXRlbXMiLCJjb250YWluZXIiLCJfY29udGFpbmVyIiwiX2Ftb3VudFBhZ2VJdGVtcyIsIl9hY3RpdmVQYWdlIiwibnVtYmVyIiwiZmlyc3QiLCJsYXN0IiwicEJ1dHRvbnNDb250ZW50IiwiYXJndW1lbnRzIiwidW5kZWZpbmVkIiwiX2dldFBCdXR0b25Db250ZW50IiwiX2dldFBCdXR0b25zTnVtYmVyQ29udGVudCIsIml0ZW1zIiwiYW1vdW50QnV0dG9ucyIsIk1hdGgiLCJjZWlsIiwiX2dldFBEb3RzQ29udGVudCIsImZpcnN0SXRlbSIsImxhc3RJdGVtIiwiX2dldFBCdXR0b25zQ29udGVudCIsIl9nZXRJdGVtc0luQWN0aXZlUGFnZSIsImNvbnRlbnQiLCJjb250YWluZXJDbGFzcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsImZpbmRDb250YWluZXJzQW5kUmVtb3ZlQ2xhc3MiLCJjbGFzc05hbWUiLCJhbGxDb250YWluZXJzIiwicXVlcnlTZWxlY3RvckFsbCIsInJlbW92ZUNsYXNzSW5Db250YWluZXIiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlciIsImVsZW1lbnQiLCJldmVudE5hbWUiLCJmbiIsImV2ZW50IiwidGFyZ2V0RWxlbWVudCIsImNvbnRhaW5zIiwic2V0QWN0aXZlUGFnZSIsImRhdGFzZXQiLCJwQnV0dG9uTnVtYmVyIiwic29ydGluZ1NldHRpbmciLCJzb3J0aW5nIiwic2V0U29ydGluZyIsImFkZCIsInNldEF2YWxpYWJsZSIsImNoZWNrZWQiLCJnb29kSWQiLCJjbG9zZXN0IiwiYmFza2V0IiwiYWRkR29vZFRvQmFza2V0IiwiZ2V0R29vZEluZm9ybWF0aW9uIiwicmVtb3ZlR29vZEZyb21CYXNrZXQiLCJwYXJlbnRFbGVtZW50IiwiYkdvb2RJZCJdLCJtYXBwaW5ncyI6IkFBQUEsYUFFQSxTQUFTQSxtQkFBbUJDLEdBQU8sT0FBT0MsbUJBQW1CRCxJQUFRRSxpQkFBaUJGLElBQVFHLHFCQUU5RixTQUFTQSxxQkFBdUIsTUFBTSxJQUFJQyxVQUFVLG1EQUVwRCxTQUFTRixpQkFBaUJHLEdBQVEsR0FBSUMsT0FBT0MsWUFBWUMsT0FBT0gsSUFBa0QsdUJBQXpDRyxPQUFPQyxVQUFVQyxTQUFTQyxLQUFLTixHQUFnQyxPQUFPTyxNQUFNQyxLQUFLUixHQUUxSixTQUFTSixtQkFBbUJELEdBQU8sR0FBSVksTUFBTUUsUUFBUWQsR0FBTSxDQUFFLElBQUssSUFBSWUsRUFBSSxFQUFHQyxFQUFPLElBQUlKLE1BQU1aLEVBQUlpQixRQUFTRixFQUFJZixFQUFJaUIsT0FBUUYsSUFBT0MsRUFBS0QsR0FBS2YsRUFBSWUsR0FBTSxPQUFPQyxHQUU3SixTQUFTRSxnQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsYUFBb0JDLEdBQWdCLE1BQU0sSUFBSWhCLFVBQVUscUNBRWhILFNBQVNpQixrQkFBa0JDLEVBQVFDLEdBQVMsSUFBSyxJQUFJUixFQUFJLEVBQUdBLEVBQUlRLEVBQU1OLE9BQVFGLElBQUssQ0FBRSxJQUFJUyxFQUFhRCxFQUFNUixHQUFJUyxFQUFXQyxXQUFhRCxFQUFXQyxhQUFjLEVBQU9ELEVBQVdFLGNBQWUsRUFBVSxVQUFXRixJQUFZ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bnRlbnQiOlsiLy8g0YLQvtCy0LDRgNGLXHJcbmNsYXNzIEdvb2RzIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRoaXMuX2dvb2RzSW5QYWdlID0gW107XHJcblx0XHR0aGlzLl9hdmFsaWFibGUgPSBmYWxzZTtcclxuXHRcdHRoaXMuX3NvcnRpbmdWYWx1ZSA9ICduYW1lJztcclxuXHR9XHJcblxyXG5cdF9zb3J0aW5nQXZhbGlhYmxlKGdvb2RzKSB7XHJcblx0XHRyZXR1cm4gZ29vZHMuZmlsdGVyKGVsZW0gPT4gZWxlbS5hdmFsaWFibGUpO1xyXG5cdH1cclxuXHJcblx0X3NvcnRpbmdCeUNvc3QoZ29vZHMpIHtcclxuXHRcdHJldHVybiBnb29kcy5zb3J0KChwcmV2LCBuZXh0KSA9PiBwcmV2LnByaWNlIC0gbmV4dC5wcmljZSk7XHJcblx0fVxyXG5cclxuXHRfc29ydGluZ0J5TmFtZShnb29kcykge1xyXG5cdFx0cmV0dXJuIGdvb2RzLnNvcnQoKHByZXYsIG5leHQpID0+IHtcclxuXHRcdFx0Y29uc3QgeCA9IHByZXYudGl0bGUudG9Mb3dlckNhc2UoKTtcclxuXHRcdFx0Y29uc3QgeSA9IG5leHQudGl0bGUudG9Mb3dlckNhc2UoKTtcclxuXHRcdFx0aWYgKHggPCB5KSByZXR1cm4gLTE7XHJcblx0XHRcdGlmICh4IDwgeSkgcmV0dXJuIDE7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdF9zb3J0aW5nKGdvb2RzKSB7XHJcblx0XHRpZiAodGhpcy5fYXZhbGlhYmxlKSBnb29kcyA9IHRoaXMuX3NvcnRpbmdBdmFsaWFibGUoZ29vZHMpO1xyXG5cclxuXHRcdGlmICh0aGlzLl9zb3J0aW5nVmFsdWUgPT0gJ2Nvc3QnKSBnb29kcyA9IHRoaXMuX3NvcnRpbmdCeUNvc3QoZ29vZHMpO1xyXG5cdFx0ZWxzZSBpZiAodGhpcy5fc29ydGluZ1ZhbHVlID09ICduYW1lJykgZ29vZHMgPSB0aGlzLl9zb3J0aW5nQnlOYW1lKGdvb2RzKTtcclxuXHRcdHJldHVybiBnb29kcztcclxuXHR9XHJcblxyXG5cdF90cnVuY2F0ZShkZXNjciwgbWF4TGVuZ3RoKSB7XHJcblx0XHRpZiAoZGVzY3IubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XHJcblx0XHRcdGxldCBnYXAgPSBkZXNjci5sYXN0SW5kZXhPZignICcsIG1heExlbmd0aCk7XHJcblx0XHRcdHJldHVybiBgJHtkZXNjci5zbGljZSgwLCBnYXApfSAuLi5gO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRlc2NyO1xyXG5cdH1cclxuXHJcblx0X2dldEdvb2RDb250ZW50KGdvb2QpIHtcclxuXHRcdGxldCB7IGlkLCBpbWFnZSwgdGl0bGUsIHByaWNlLCBkZXNjciB9ID0gZ29vZDtcclxuXHRcdHJldHVybiBgPGRpdiBjbGFzcz1cImdvb2RfX2l0ZW0ganMtZ29vZC1pdGVtXCIgZGF0YS1nb29kLWlkPSR7aWR9PlxyXG5cdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX2ltYWdlXCI+PGltZyBzcmM9XCIke2ltYWdlfVwiLz48L2Rpdj5cclxuXHRcdFx0XHRcdDxkaXYgY2xhc3M9XCJnb29kX19pbmZvcm1hdGlvblwiPlxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9fdGl0bGVcIj4ke3RpdGxlfTwvZGl2PlxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9fcHJpY2VcIj4ke3ByaWNlfSDRgNGD0LE8L2Rpdj5cclxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzcz1cImdvb2RfX2Rlc2NyaXB0aW9uXCI+JHt0aGlzLl90cnVuY2F0ZShkZXNjciwgNjUpfTwvZGl2PlxyXG5cdFx0XHRcdFx0PC9kaXY+XHJcblx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9fdHJhbnNhY3Rpb25cIj5cclxuXHRcdFx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cImdvb2RfX2J1dHRvbiBqcy1hZGQtdG8tYmFza2V0XCI+0JTQvtCx0LDQstC40YLRjCDQsiDQutC+0YDQt9C40L3RgzwvYnV0dG9uPlxyXG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzPVwiZ29vZF9fYmFza2V0LWZlZWRiYWNrIGpzLWdvb2QtaW4tYmFza2V0XCI+PC9kaXY+XHJcblx0XHRcdFx0XHQ8L2Rpdj5cclxuXHRcdFx0XHQ8L2Rpdj5gO1xyXG5cdH1cclxuXHJcblx0X2FkZEdvb2RzVG9Db250YWluZXIoZ29vZHMpIHtcclxuXHRcdHRoaXMuX2dvb2RzSW5QYWdlID0gZ29vZHM7XHJcblx0XHRjb25zdCBnb29kc0NvbnRlbnQgPSBnb29kcy5tYXAoZ29vZCA9PiB0aGlzLl9nZXRHb29kQ29udGVudChnb29kKSkuam9pbignJyk7XHJcblx0XHRhZGRDb250ZW50VG9Db250YWluZXIoZ29vZHNDb250ZW50LCAnLmpzLWdvb2QnKTtcclxuXHR9XHJcblxyXG5cdGxvYWRHb29kcygpIHtcclxuXHRcdGZldGNoKCdodHRwczovL2R6YWRyYW5pay5naXRodWIuaW8vZ29vZHMtYW5kLWJhc2tldC9zcmMvanNvbi9nb29kcy5qc29uJylcclxuXHRcdFx0LnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxyXG5cdFx0XHQudGhlbihnb29kcyA9PiB7XHJcblx0XHRcdFx0dGhpcy5fYWRkR29vZHNUb0NvbnRhaW5lcihnb29kc1BhZ2luZy5hZGRQYWdpbmdHZXRJdGVtc0luUGFnZSh0aGlzLl9zb3J0aW5nKGdvb2RzKSkpO1xyXG5cdFx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHNldEF2YWxpYWJsZSh2YWx1ZSkge1xyXG5cdFx0dGhpcy5fYXZhbGlhYmxlID0gdmFsdWU7XHJcblx0XHR0aGlzLmxvYWRHb29kcygpO1xyXG5cdH1cclxuXHJcblx0c2V0U29ydGluZyh2YWx1ZSkge1xyXG5cdFx0aWYgKHRoaXMuX3NvcnRpbmdWYWx1ZSAhPSB2YWx1ZSkge1xyXG5cdFx0XHR0aGlzLl9zb3J0aW5nVmFsdWUgPSB2YWx1ZTtcclxuXHRcdFx0dGhpcy5sb2FkR29vZHMoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGdldEdvb2RJbmZvcm1hdGlvbihpZCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2dvb2RzSW5QYWdlLmZpbmQoaXRlbSA9PiBpdGVtLmlkID09IGlkKTtcclxuXHR9XHJcbn1cclxuXHJcbi8v0LrQvtGA0LfQuNC90LBcclxuY2xhc3MgQmFza2V0IHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRoaXMuX2dvb2RzSW5CYXNrZXQgPVxyXG5cdFx0XHRsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZ29vZHNJbkJhc2tldCcpICE9IG51bGwgPyBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdnb29kc0luQmFza2V0JykpIDogW107XHJcblx0fVxyXG5cclxuXHRfZ2V0R29vZENvbnRlbnQoZ29vZCkge1xyXG5cdFx0Y29uc3QgeyBpZCwgaW1hZ2UsIHRpdGxlLCBjb3VudCB9ID0gZ29vZDtcclxuXHRcdHJldHVybiBgPGRpdiBjbGFzcz1cImJhc2tldF9fZ29vZC1pdGVtXCIgZGF0YS1iLWdvb2QtaWQ9XCIke2lkfVwiPlxyXG5cdFx0XHQ8YnV0dG9uIGNsYXNzPVwiYmFza2V0X19nb29kLXJlbW92ZSBqcy1yZW1vdmUtZ29vZFwiPiYjMTI4OTM4OzwvYnV0dG9uPlxyXG5cdFx0XHQ8ZGl2IGNsYXNzPVwiYmFza2V0X19nb29kLWltYWdlXCI+PGltZyBzcmM9XCIke2ltYWdlfVwiLz48L2Rpdj5cclxuXHRcdFx0PGRpdiBjbGFzcz1cImJhc2tldF9fZ29vZC1uYW1lXCI+JHt0aXRsZX08L2Rpdj5cclxuXHRcdFx0PGRpdiBjbGFzcz1cImJhc2tldF9fZ29vZC1hbW91dFwiPiR7Y291bnR9PC9kaXY+XHJcblx0XHQ8L2Rpdj5gO1xyXG5cdH1cclxuXHJcblx0X2FkZEdvb2RzVG9Db250YWluZXIoKSB7XHJcblx0XHRjb25zdCBnb29kc0NvbnRlbnQgPSB0aGlzLl9nb29kc0luQmFza2V0Lm1hcChnb29kID0+IHRoaXMuX2dldEdvb2RDb250ZW50KGdvb2QpKS5qb2luKCcnKTtcclxuXHRcdGFkZENvbnRlbnRUb0NvbnRhaW5lcihnb29kc0NvbnRlbnQsICcuanMtYmFza2V0LWdvb2QnKTtcclxuXHR9XHJcblxyXG5cdF9maW5kR29vZEFuZFJlbW92ZShpZCkge1xyXG5cdFx0Y29uc3QgZ29vZEluZGV4ID0gdGhpcy5fZ29vZHNJbkJhc2tldC5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLmlkID09PSAraWQpO1xyXG5cdFx0cmV0dXJuIHRoaXMuX2dvb2RzSW5CYXNrZXQuc3BsaWNlKGdvb2RJbmRleCwgMSk7XHJcblx0fVxyXG5cclxuXHRfZmluZEdvb2RBbmRBZGQoZ29vZCkge1xyXG5cdFx0Y29uc3QgZ29vZEluQmFza2V0ID0gdGhpcy5fZ29vZHNJbkJhc2tldC5maW5kKGl0ZW0gPT4gaXRlbS5pZCA9PT0gZ29vZC5pZCk7XHJcblx0XHRpZiAoZ29vZEluQmFza2V0KSB7XHJcblx0XHRcdGdvb2RJbkJhc2tldC5jb3VudCsrO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Z29vZC5jb3VudCA9IDE7XHJcblx0XHRcdHRoaXMuX2dvb2RzSW5CYXNrZXQgPSBbLi4udGhpcy5fZ29vZHNJbkJhc2tldCwgZ29vZF07XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRfYWRkVG90YWxDb3N0KCkge1xyXG5cdFx0Y29uc3QgdG90YWxDb3N0ID0gdGhpcy5fZ29vZHNJbkJhc2tldC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgaXRlbS5jb3VudCAqIGl0ZW0ucHJpY2UsIDApO1xyXG5cdFx0YWRkQ29udGVudFRvQ29udGFpbmVyKHRvdGFsQ29zdCwgJy5qcy1jb3VudC1yZXN1bHQnKTtcclxuXHR9XHJcblxyXG5cdF9zYXZlVG9Mb2NhbFN0b3JhZ2UoKSB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuZ29vZHNJbkJhc2tldCA9IEpTT04uc3RyaW5naWZ5KHRoaXMuX2dvb2RzSW5CYXNrZXQpO1xyXG5cdH1cclxuXHJcblx0X2NvdW50R29vZHNJbkJhc2tldCgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9nb29kc0luQmFza2V0LnJlZHVjZSgoc3VtLCBpdGVtKSA9PiBzdW0gKyBpdGVtLmNvdW50LCAwKTtcclxuXHR9XHJcblxyXG5cdGFkZENvdW50R29vZHNJbkJhc2tldCgpIHtcclxuXHRcdGFkZENvbnRlbnRUb0NvbnRhaW5lcih0aGlzLl9jb3VudEdvb2RzSW5CYXNrZXQoKSwgJy5qcy1nb29kLWluLWJhc2tldCcpO1xyXG5cdH1cclxuXHJcblx0YWRkR29vZFRvQmFza2V0KGdvb2QpIHtcclxuXHRcdHRoaXMuX2ZpbmRHb29kQW5kQWRkKGdvb2QpO1xyXG5cdFx0dGhpcy5fc2F2ZVRvTG9jYWxTdG9yYWdlKCk7XHJcblx0XHR0aGlzLnJlbG9hZEJhc2tldCgpO1xyXG5cdH1cclxuXHJcblx0cmVtb3ZlR29vZEZyb21CYXNrZXQoaWQpIHtcclxuXHRcdHRoaXMuX2ZpbmRHb29kQW5kUmVtb3ZlKGlkKTtcclxuXHRcdHRoaXMuX3NhdmVUb0xvY2FsU3RvcmFnZSgpO1xyXG5cdFx0dGhpcy5yZWxvYWRCYXNrZXQoKTtcclxuXHR9XHJcblxyXG5cdHJlbG9hZEJhc2tldCgpIHtcclxuXHRcdHRoaXMuX2FkZEdvb2RzVG9Db250YWluZXIoKTtcclxuXHRcdHRoaXMuX2FkZFRvdGFsQ29zdCgpO1xyXG5cdH1cclxufVxyXG5cclxuLy/Qv9Cw0LPQuNC90LDRhtC40Y9cclxuY2xhc3MgUGFnaW5nIHtcclxuXHRjb25zdHJ1Y3RvcihhbW91bnRQYWdlSXRlbXMsIGNvbnRhaW5lcikge1xyXG5cdFx0dGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG5cdFx0dGhpcy5fYW1vdW50UGFnZUl0ZW1zID0gYW1vdW50UGFnZUl0ZW1zO1xyXG5cdFx0dGhpcy5fYWN0aXZlUGFnZSA9IDA7XHJcblx0fVxyXG5cclxuXHRfZ2V0UEJ1dHRvbkNvbnRlbnQobnVtYmVyKSB7XHJcblx0XHRyZXR1cm4gYDxidXR0b24gXHJcblx0XHRcdFx0XHRjbGFzcz1cInBhZ2luYXRpb25fX2J1dHRvbiBqcy1wYWdpbmF0aW9uLWJ1dHRvbiBcclxuXHRcdFx0XHRcdCR7bnVtYmVyID09PSB0aGlzLl9hY3RpdmVQYWdlID8gJ2FjdGl2ZScgOiAnJ31cIiBcclxuXHRcdFx0XHRcdGRhdGEtcC1idXR0b24tbnVtYmVyPVwiJHtudW1iZXIgKyAxfVwiPlxyXG5cdFx0XHRcdFx0XHQke251bWJlciArIDF9XHJcblx0XHRcdFx0PC9idXR0b24+YDtcclxuXHR9XHJcblxyXG5cdF9nZXRQRG90c0NvbnRlbnQoKSB7XHJcblx0XHRyZXR1cm4gYDxzcGFuIGNsYXNzPSdwYWdpbmF0aW9uX19kb3RzJz4uLi48L3NwYW4+YDtcclxuXHR9XHJcblxyXG5cdF9nZXRQQnV0dG9uc051bWJlckNvbnRlbnQoZmlyc3QsIGxhc3QsIHBCdXR0b25zQ29udGVudCA9ICcnKSB7XHJcblx0XHRpZiAoZmlyc3QgPCBsYXN0KSB7XHJcblx0XHRcdHBCdXR0b25zQ29udGVudCArPSB0aGlzLl9nZXRQQnV0dG9uQ29udGVudChmaXJzdCk7XHJcblx0XHRcdHJldHVybiB0aGlzLl9nZXRQQnV0dG9uc051bWJlckNvbnRlbnQoZmlyc3QgKyAxLCBsYXN0LCBwQnV0dG9uc0NvbnRlbnQpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHBCdXR0b25zQ29udGVudDtcclxuXHR9XHJcblxyXG5cdF9nZXRQQnV0dG9uc0NvbnRlbnQoaXRlbXMpIHtcclxuXHRcdGxldCBhbW91bnRCdXR0b25zID0gTWF0aC5jZWlsKGl0ZW1zLmxlbmd0aCAvIHRoaXMuX2Ftb3VudFBhZ2VJdGVtcyksIC8vINC60L7Qu9C40YfQtdGB0YLQstC+INGB0YLRgNCw0L3QuNGGXHJcblx0XHRcdHBCdXR0b25zQ29udGVudCA9ICcnOyAvLyDRgNCw0LfQvNC10YLQutCwINC60L3QvtC/0L7QuiDQv9Cw0LPQuNC90LDRhtC40LhcclxuXHJcblx0XHRpZiAoYW1vdW50QnV0dG9ucyA+IDYpIHtcclxuXHRcdFx0aWYgKHRoaXMuX2FjdGl2ZVBhZ2UgPCAyIHx8IHRoaXMuX2FjdGl2ZVBhZ2UgPiBhbW91bnRCdXR0b25zIC0gMykge1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSB0aGlzLl9nZXRQQnV0dG9uc051bWJlckNvbnRlbnQoMCwgMyk7XHJcblx0XHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IHRoaXMuX2dldFBEb3RzQ29udGVudCgpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSB0aGlzLl9nZXRQQnV0dG9uc051bWJlckNvbnRlbnQoYW1vdW50QnV0dG9ucyAtIDMsIGFtb3VudEJ1dHRvbnMpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMuX2FjdGl2ZVBhZ2UgPT0gMikge1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSB0aGlzLl9nZXRQQnV0dG9uc051bWJlckNvbnRlbnQoMCwgNCk7XHJcblx0XHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IHRoaXMuX2dldFBEb3RzQ29udGVudCgpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSB0aGlzLl9nZXRQQnV0dG9uc051bWJlckNvbnRlbnQoYW1vdW50QnV0dG9ucyAtIDEsIGFtb3VudEJ1dHRvbnMpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMuX2FjdGl2ZVBhZ2UgPT0gYW1vdW50QnV0dG9ucyAtIDMpIHtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gdGhpcy5fZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KDAsIDEpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSB0aGlzLl9nZXRQRG90c0NvbnRlbnQoKTtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gdGhpcy5fZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KGFtb3VudEJ1dHRvbnMgLSA0LCBhbW91bnRCdXR0b25zKTtcclxuXHRcdFx0fSBlbHNlIGlmICh0aGlzLl9hY3RpdmVQYWdlID4gMiAmJiB0aGlzLl9hY3RpdmVQYWdlIDwgYW1vdW50QnV0dG9ucyAtIDMpIHtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gdGhpcy5fZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KDAsIDEpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSB0aGlzLl9nZXRQRG90c0NvbnRlbnQoKTtcclxuXHRcdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gdGhpcy5fZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KHRoaXMuX2FjdGl2ZVBhZ2UgLSAxLCB0aGlzLl9hY3RpdmVQYWdlICsgMik7XHJcblx0XHRcdFx0cEJ1dHRvbnNDb250ZW50ICs9IHRoaXMuX2dldFBEb3RzQ29udGVudCgpO1xyXG5cdFx0XHRcdHBCdXR0b25zQ29udGVudCArPSB0aGlzLl9nZXRQQnV0dG9uc051bWJlckNvbnRlbnQoYW1vdW50QnV0dG9ucyAtIDEsIGFtb3VudEJ1dHRvbnMpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRwQnV0dG9uc0NvbnRlbnQgKz0gdGhpcy5fZ2V0UEJ1dHRvbnNOdW1iZXJDb250ZW50KDAsIGFtb3VudEJ1dHRvbnMpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHBCdXR0b25zQ29udGVudDtcclxuXHR9XHJcblxyXG5cdF9nZXRJdGVtc0luQWN0aXZlUGFnZShpdGVtcykge1xyXG5cdFx0Y29uc3QgZmlyc3RJdGVtID0gdGhpcy5fYWN0aXZlUGFnZSAqIHRoaXMuX2Ftb3VudFBhZ2VJdGVtcyxcclxuXHRcdFx0bGFzdEl0ZW0gPSBmaXJzdEl0ZW0gKyB0aGlzLl9hbW91bnRQYWdlSXRlbXM7XHJcblx0XHRyZXR1cm4gaXRlbXMuc2xpY2UoZmlyc3RJdGVtLCBsYXN0SXRlbSk7XHJcblx0fVxyXG5cclxuXHRzZXRBY3RpdmVQYWdlKG51bWJlcikge1xyXG5cdFx0dGhpcy5fYWN0aXZlUGFnZSA9IG51bWJlcjtcclxuXHR9XHJcblxyXG5cdGFkZFBhZ2luZ0dldEl0ZW1zSW5QYWdlKGl0ZW1zKSB7XHJcblx0XHRhZGRDb250ZW50VG9Db250YWluZXIodGhpcy5fZ2V0UEJ1dHRvbnNDb250ZW50KGl0ZW1zKSwgdGhpcy5fY29udGFpbmVyKTtcclxuXHRcdHJldHVybiB0aGlzLl9nZXRJdGVtc0luQWN0aXZlUGFnZShpdGVtcyk7XHJcblx0fVxyXG59XHJcblxyXG4vL9CU0L7QsdCw0LLQu9C10L3QuNC1INGN0LvQtdC80LXQvdGC0L7QsiDQsiDQutC+0L3RgtC10LnQvdC10YBcclxuZnVuY3Rpb24gYWRkQ29udGVudFRvQ29udGFpbmVyKGNvbnRlbnQsIGNvbnRhaW5lckNsYXNzKSB7XHJcblx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJDbGFzcyk7XHJcblx0aWYgKGNvbnRhaW5lcikgY29udGFpbmVyLmlubmVySFRNTCA9IGNvbnRlbnQ7XHJcbn1cclxuXHJcbi8v0YPQtNCw0LvQuNGC0Ywg0LrQu9Cw0YHRgSDRgyDQs9GA0YPQv9C/0Ysg0LrQvtC90YLQtdC50L3QtdGA0L7QslxyXG5mdW5jdGlvbiBmaW5kQ29udGFpbmVyc0FuZFJlbW92ZUNsYXNzKGNvbnRhaW5lckNsYXNzLCBjbGFzc05hbWUpIHtcclxuXHRjb25zdCBhbGxDb250YWluZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb250YWluZXJDbGFzcyksXHJcblx0XHRyZW1vdmVDbGFzc0luQ29udGFpbmVyID0gKGkgPSAwKSA9PiB7XHJcblx0XHRcdGlmIChpIDwgYWxsQ29udGFpbmVycy5sZW5ndGgpIHtcclxuXHRcdFx0XHRhbGxDb250YWluZXJzW2ldLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcclxuXHRcdFx0XHRyZXR1cm4gcmVtb3ZlQ2xhc3NJbkNvbnRhaW5lcihpICsgMSk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0cmVtb3ZlQ2xhc3NJbkNvbnRhaW5lcigpO1xyXG59XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XHJcblx0Y29uc3QgaGFuZGxlciA9IChlbGVtZW50LCBldmVudE5hbWUsIGZuKSA9PiB7XHJcblx0XHRjb25zdCBlbGVtZW50Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KTtcclxuXHRcdGVsZW1lbnRDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGV2ZW50ID0+IGZuKGV2ZW50KSk7XHJcblx0fTtcclxuXHJcblx0Ly/RgdC70YPRiNCw0LvQutCwINC60L3QvtC/0L7QuiDQv9Cw0LPQuNC90LDRgtC+0YDQsFxyXG5cdGhhbmRsZXIoJy5qcy1wYWdpbmF0aW9uJywgJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0Y29uc3QgdGFyZ2V0RWxlbWVudCA9IGV2ZW50LnRhcmdldDtcclxuXHRcdGlmICh0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanMtcGFnaW5hdGlvbi1idXR0b24nKSAmJiAhdGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7XHJcblx0XHRcdGdvb2RzUGFnaW5nLnNldEFjdGl2ZVBhZ2UodGFyZ2V0RWxlbWVudC5kYXRhc2V0LnBCdXR0b25OdW1iZXIgLSAxKTtcclxuXHRcdFx0Z29vZHMubG9hZEdvb2RzKCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdC8vINGB0LvRg9GI0LDQu9C60LAg0YHQvtGA0YLQuNGA0L7QstC+0LpcclxuXHRoYW5kbGVyKCcuanMtc29ydGluZy1idXR0b25zJywgJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0Y29uc3QgdGFyZ2V0RWxlbWVudCA9IGV2ZW50LnRhcmdldDtcclxuXHRcdGlmICh0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanMtc29ydGluZycpICYmICF0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcclxuXHRcdFx0Y29uc3Qgc29ydGluZ1NldHRpbmcgPSB0YXJnZXRFbGVtZW50LmRhdGFzZXQuc29ydGluZztcclxuXHRcdFx0ZmluZENvbnRhaW5lcnNBbmRSZW1vdmVDbGFzcygnLmpzLXNvcnRpbmcnLCAnYWN0aXZlJyk7XHJcblx0XHRcdGdvb2RzLnNldFNvcnRpbmcoc29ydGluZ1NldHRpbmcpO1xyXG5cdFx0XHR0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHQvLyDRgdC70YPRiNCw0LvQutCwINGB0L7RgNGC0LjRgNC+0LLQutC4INC/0L4g0L3QsNC70LjRh9C40Y5cclxuXHRoYW5kbGVyKCcuanMtYXZhbGlhYmxlJywgJ2NoYW5nZScsIGV2ZW50ID0+IHtcclxuXHRcdGdvb2RzUGFnaW5nLnNldEFjdGl2ZVBhZ2UoMCk7XHJcblx0XHRnb29kcy5zZXRBdmFsaWFibGUoZXZlbnQudGFyZ2V0LmNoZWNrZWQpO1xyXG5cdH0pO1xyXG5cclxuXHQvLyDQutC90L7Qv9C60LAg0LTQvtCx0LDQstC40YLRjCDQsiDQutC+0YDQt9C40L3Rg1xyXG5cdGhhbmRsZXIoJy5qcy1nb29kJywgJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0aWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLWFkZC10by1iYXNrZXQnKSkge1xyXG5cdFx0XHRsZXQgZ29vZElkID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5qcy1nb29kLWl0ZW0nKS5kYXRhc2V0Lmdvb2RJZDtcclxuXHRcdFx0YmFza2V0LmFkZEdvb2RUb0Jhc2tldChnb29kcy5nZXRHb29kSW5mb3JtYXRpb24oZ29vZElkKSk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdC8vINC60L3QvtC/0LrQsCDRg9C00LDQu9C40YLRjCDQuNC3INC60L7RgNC30LjQvdGLXHJcblx0aGFuZGxlcignLmpzLWJhc2tldC1nb29kJywgJ2NsaWNrJywgZXZlbnQgPT4ge1xyXG5cdFx0aWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLXJlbW92ZS1nb29kJykpIHtcclxuXHRcdFx0YmFza2V0LnJlbW92ZUdvb2RGcm9tQmFza2V0KGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50LmRhdGFzZXQuYkdvb2RJZCk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn0pO1xyXG5cclxuY29uc3QgYmFza2V0ID0gbmV3IEJhc2tldCgpLFxyXG5cdGdvb2RzID0gbmV3IEdvb2RzKCksXHJcblx0Z29vZHNQYWdpbmcgPSBuZXcgUGFnaW5nKDUsICcuanMtcGFnaW5hdGlvbicpO1xyXG5cclxuZ29vZHMubG9hZEdvb2RzKCk7XHJcbmJhc2tldC5yZWxvYWRCYXNrZXQoKTtcclxuIl19
